<!DOCTYPE html>
<html lang="zh" dir="ltr">
  <head>
    <meta charset="utf-8">
    
    <title>Elysia 0.7 - Stellar Stellar - Elysia 中文文档</title>
    <meta name="description" content="介绍高达 13 倍的更快类型推断。带有跟踪的声明式遥测。反应式 cookie 模型和 cookie 验证。支持 TypeBox 0.31 和自定义解码器。重写的 Web Socket。定义重映射和自定义后缀。为 Elysia 提供更坚实的基础，展望更光明的未来。">
    <meta name="generator" content="VitePress v2.0.0-alpha.15">
    <link rel="preload stylesheet" href="/assets/style.DxhFWJeQ.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.BFhO6Lf6.js"></script>
    <link rel="modulepreload" href="/assets/chunks/plugin-vue_export-helper.CKgBKD3c.js">
    <link rel="modulepreload" href="/assets/chunks/preload-helper.CPrT4D5T.js">
    <link rel="modulepreload" href="/assets/chunks/client.Bm-rI_R6.js">
    <link rel="modulepreload" href="/assets/chunks/use-dark.D_Ezswh_.js">
    <link rel="modulepreload" href="/assets/chunks/ray.DH5EacAR.js">
    <link rel="modulepreload" href="/assets/chunks/sponsor.data.9Il3pjW5.js">
    <link rel="modulepreload" href="/assets/chunks/floating-ui.core.DWOiM_yY.js">
    <link rel="modulepreload" href="/assets/chunks/vue.runtime.esm-bundler.BB7fvrom.js">
    <link rel="modulepreload" href="/assets/chunks/dist.CXSQmjX6.js">
    <link rel="modulepreload" href="/assets/chunks/createLucideIcon.nO6fZ36v.js">
    <link rel="modulepreload" href="/assets/chunks/file.B0qe36Kb.js">
    <link rel="modulepreload" href="/assets/chunks/search.KaGBbfxL.js">
    <link rel="modulepreload" href="/assets/chunks/sparkles.DZ7QL8Kt.js">
    <link rel="modulepreload" href="/assets/chunks/pinia.BlUWc_69.js">
    <link rel="modulepreload" href="/assets/chunks/Layout.BZ0rZhD9.js">
    <link rel="modulepreload" href="/assets/chunks/banner.DpkE44SY.js">
    <link rel="modulepreload" href="/assets/blog_elysia-07.md.DKoM3KRH.lean.js">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <link rel="icon" href="/assets/elysia.png">
    <meta property="og:image" content="https://elysiajs.com/blog/elysia-07/stellar-stellar.webp">
    <meta property="og:image:width" content="2560">
    <meta property="og:image:height" content="1440">
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:image" content="https://elysiajs.com/blog/elysia-07/stellar-stellar.webp">
    <meta property="og:title" content="介绍 Elysia 0.7 - Stellar Stellar">
    <meta property="og:description" content="介绍高达 13 倍的更快类型推断。带有跟踪的声明式遥测。反应式 cookie 模型和 cookie 验证。支持 TypeBox 0.31 和自定义解码器。重写的 Web Socket。定义重映射和自定义后缀。为 Elysia 提供更坚实的基础，展望更光明的未来。">
    <script async src="https://www.zhcndoc.com/js/common.js"></script>
    <link rel="preload" as="image" href="/assets/elysia_v.webp" fetchpriority="high">
    <link rel="preload" as="image" href="/assets/elysia.svg" fetchpriority="high">
    <link rel="preload" as="image" href="/assets/shigure-ui-smol.gif" fetchpriority="low">
    <script id="check-dark-mode">(()=>{let e=localStorage.getItem(`vitepress-theme-appearance`)||`auto`,t=window.matchMedia(`(prefers-color-scheme: dark)`).matches;(!e||e===`auto`?t:e===`dark`)&&document.documentElement.classList.add(`dark`)})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle(`mac`,/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body><!--teleport start anchor--><div role="button" aria-expanded="true" aria-haspopup="listbox" aria-labelledby="localsearch-label" class="pointer-events-none VPLocalSearchBox" data-v-0fd83197><!--[--><!--]--><!--[--><!--]--><button data-v-0fd83197></button></div><!--teleport anchor-->
    <div id="app"><div class="Layout" data-v-1df9f90f><!--[--><!--]--><!--[--><span tabindex="-1" data-v-331ec75c></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-331ec75c>Skip to content</a><!--]--><!----><header class="VPNav" data-v-1df9f90f data-v-da52a441><div class="VPNavBar" data-v-da52a441 data-v-70946a35><div class="wrapper" data-v-70946a35><div class="container" data-v-70946a35><div class="title" data-v-70946a35><div class="VPNavBarTitle" data-v-70946a35 data-v-1e38c6bc><a class="title" href="/" data-v-1e38c6bc><!--[--><!--]--><!--[--><img class="VPImage logo" src="/assets/elysia.svg" alt data-v-8426fc1a><!--]--><span data-v-1e38c6bc>Elysia 中文文档</span><!--[--><!--]--></a></div></div><div class="content" data-v-70946a35><div class="content-body" data-v-70946a35><!--[--><!--[--><!--[--><button class="clicky lg:hidden size-10 ml-4 grid place-items-center text-cyan-400 dark:text-cyan-300 font-medium bg-cyan-300/10 dark:bg-cyan-300/5 !rounded-lg backdrop-blur-md"><svg xmlns="http://www.w3.org/2000/svg" width="21" height="21" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sparkles-icon lucide-sparkles"><path d="M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z"></path><path d="M20 2v4"></path><path d="M22 4h-4"></path><circle cx="4" cy="20" r="2"></circle></svg></button><!----><!--]--><!--]--><!--]--><section class="VPNavBarSearch search" data-v-70946a35><!--teleport start--><!--teleport end--><div id="local-search"><button type="button" aria-label="搜索文档" aria-keyshortcuts="/ control+k meta+k" class="DocSearch DocSearch-Button"><span class="DocSearch-Button-Container"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.375" stroke-linecap="round" stroke-linejoin="round" class="lucide inline -translate-y-0.25 scale-125 sm:scale-100 lucide-search-icon lucide-search inline -translate-y-0.25 scale-125 sm:scale-100"><path d="m21 21-4.34-4.34"></path><circle cx="11" cy="11" r="8"></circle></svg><span class="DocSearch-Button-Placeholder">搜索文档</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key"></kbd></span></button></div></section><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-70946a35 data-v-39714824><span id="main-nav-aria-label" class="visually-hidden" data-v-39714824> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/table-of-content.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>文档</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blog.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>博客</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/illust.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>Illust</span><!--]--></a><!--]--><!--]--></nav><div class="VPFlyout VPNavBarTranslations translations" data-v-70946a35 data-v-4c1766e2 data-v-42cb505d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="多语言" data-v-42cb505d><span class="text" data-v-42cb505d><span class="vpi-languages option-icon" data-v-42cb505d></span><!----><span class="vpi-chevron-down text-icon" data-v-42cb505d></span></span></button><div class="menu" data-v-42cb505d><div class="VPMenu" data-v-42cb505d data-v-25a6cce8><!----><!--[--><!--[--><div class="items" data-v-4c1766e2><p class="title" data-v-4c1766e2>简体中文</p><!--[--><div class="VPMenuLink" data-v-4c1766e2 data-v-faf5b206><a class="VPLink link vp-external-link-icon" href="https://elysiajs.com/blog/elysia-07.html" target="_blank" rel="noreferrer" lang="en" data-v-faf5b206><!--[--><span data-v-faf5b206>English</span><!--]--></a></div><!--]--></div><!--]--><!--]--></div></div></div><div class="VPNavBarAppearance appearance" data-v-70946a35 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-70946a35 data-v-0394ad82 data-v-d07f11e6><!--[--><a class="VPSocialLink no-icon" href="https://github.com/elysiajs/elysia" aria-label="github" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="https://twitter.com/elysiajs" aria-label="twitter" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-twitter"></span></a><a class="VPSocialLink no-icon" href="https://discord.gg/eaFJ2KDJck" aria-label="discord" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-discord"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-70946a35 data-v-bf2fac68 data-v-42cb505d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-42cb505d><span class="vpi-more-horizontal icon" data-v-42cb505d></span></button><div class="menu" data-v-42cb505d><div class="VPMenu" data-v-42cb505d data-v-25a6cce8><!----><!--[--><!--[--><div class="group translations" data-v-bf2fac68><p class="trans-title" data-v-bf2fac68>简体中文</p><!--[--><div class="VPMenuLink" data-v-bf2fac68 data-v-faf5b206><a class="VPLink link vp-external-link-icon" href="https://elysiajs.com/blog/elysia-07.html" target="_blank" rel="noreferrer" lang="en" data-v-faf5b206><!--[--><span data-v-faf5b206>English</span><!--]--></a></div><!--]--></div><div class="group" data-v-bf2fac68><div class="item appearance" data-v-bf2fac68><p class="label" data-v-bf2fac68>主题</p><div class="appearance-action" data-v-bf2fac68><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bf2fac68 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bf2fac68><div class="item social-links" data-v-bf2fac68><div class="VPSocialLinks social-links-list" data-v-bf2fac68 data-v-d07f11e6><!--[--><a class="VPSocialLink no-icon" href="https://github.com/elysiajs/elysia" aria-label="github" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="https://twitter.com/elysiajs" aria-label="twitter" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-twitter"></span></a><a class="VPSocialLink no-icon" href="https://discord.gg/eaFJ2KDJck" aria-label="discord" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-discord"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-70946a35 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-70946a35><div class="divider-line" data-v-70946a35></div></div></div><!----></header><div class="VPLocalNav empty fixed" data-v-1df9f90f data-v-db738f89><div class="container" data-v-db738f89><!----><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-db738f89 data-v-0bf0e06f><button data-v-0bf0e06f>回到顶部</button><!----></div></div></div><!----><div class="VPContent" id="VPContent" data-v-1df9f90f data-v-c87f25bf><div class="VPDoc has-aside" data-v-c87f25bf data-v-7011f0d8><!--[--><!--[--><!--[--><div class="absolute flex flex-col z-[40] w-full !max-w-full items-center justify-center bg-transparent transition-bg overflow-hidden h-[220px] top-0 left-0 opacity-25 dark:opacity-[.55] pointer-events-none" data-v-bf23a8df><div class="-static ray absolute opacity-60" data-v-bf23a8df></div></div><!--]--><!--]--><!--]--><div class="container" data-v-7011f0d8><div class="aside" data-v-7011f0d8><div class="aside-curtain" data-v-7011f0d8></div><div class="aside-container" data-v-7011f0d8><div class="aside-content" data-v-7011f0d8><div class="VPDocAside" data-v-7011f0d8 data-v-3f215769><!--[--><!--]--><!--[--><!--[--><!--[--><!--[--><div className="relative mb-4 w-full rounded-md border border-gray-950/5 p-2 dark:border-white/10"><a href="https://www.rainyun.com/mm_?s=zhcndoc" target="_blank" className="absolute inset-0 z-10" data-umami-event="ads-rainyun"></a><div className="flex w-full justify-center"><img src="/ads/rainyun_1.png" className="w-full rounded-sm"></div></div><!--]--><!--]--><!--]--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-60d5052e><div class="content" data-v-60d5052e><div class="outline-marker" data-v-60d5052e></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-60d5052e>目录</div><ul class="VPDocOutlineItem root" data-v-60d5052e data-v-1ce71065><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-7011f0d8><div class="content-container" data-v-7011f0d8><!--[--><!--[--><!--[--><div id="open-elysia-in" class="flex gap-2.5 justify-between items-center pt-0.5 pr-2 text-gray-400 dark:text-gray-500 text-xs mb-1"><button class="flex items-center gap-1 clicky pl-2 pr-1 py-1 -translate-x-2 rounded-full interact:text-sky-500 interact:bg-sky-300/15 transition duration-500 ease-out-expo"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.25" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sparkles-icon lucide-sparkles"><path d="M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z"></path><path d="M20 2v4"></path><path d="M22 4h-4"></path><circle cx="4" cy="20" r="2"></circle></svg> 询问此页面 </button><div class="relative z-10 flex justify-center items-center gap-2.5 *:z-20 [&amp;&gt;a&gt;svg]:size-4.5 sm:[&amp;&gt;a&gt;svg]:size-5 [&amp;&gt;a&gt;svg]:opacity-50 [&amp;&gt;a&gt;svg]:interact:opacity-100 [&amp;&gt;a&gt;svg]:transition-opacity"> 在 AI 工具中打开 <a href="https://chatgpt.com/?prompt=%E6%88%91%E6%AD%A3%E5%9C%A8%E6%9F%A5%E7%9C%8B%20https://elysia.zhcndoc.com/blog/elysia-07.html%E3%80%82%0A%0A%E8%AF%B7%E6%82%A8%E8%A7%A3%E9%87%8A%E4%B8%80%E4%B8%8B%E8%BF%99%E4%B8%AA%E6%A6%82%E5%BF%B5%EF%BC%8C%E6%80%BB%E7%BB%93%E4%B8%80%E4%B8%8B%EF%BC%8C%E5%B9%B6%E5%9B%9E%E7%AD%94%E6%88%91%E5%85%B3%E4%BA%8E%E5%AE%83%E7%9A%84%E4%BB%BB%E4%BD%95%E9%97%AE%E9%A2%98%E5%A5%BD%E5%90%97%EF%BC%9F" class="clicky" target="_blank" rel="noopener noreferrer" title="Open in ChatGPT"><svg preserveAspectRatio="xMidYMid" viewBox="0 0 256 260" fill="currentColor"><path d="M239.184 106.203a64.716 64.716 0 0 0-5.576-53.103C219.452 28.459 191 15.784 163.213 21.74A65.586 65.586 0 0 0 52.096 45.22a64.716 64.716 0 0 0-43.23 31.36c-14.31 24.602-11.061 55.634 8.033 76.74a64.665 64.665 0 0 0 5.525 53.102c14.174 24.65 42.644 37.324 70.446 31.36a64.72 64.72 0 0 0 48.754 21.744c28.481.025 53.714-18.361 62.414-45.481a64.767 64.767 0 0 0 43.229-31.36c14.137-24.558 10.875-55.423-8.083-76.483Zm-97.56 136.338a48.397 48.397 0 0 1-31.105-11.255l1.535-.87 51.67-29.825a8.595 8.595 0 0 0 4.247-7.367v-72.85l21.845 12.636c.218.111.37.32.409.563v60.367c-.056 26.818-21.783 48.545-48.601 48.601Zm-104.466-44.61a48.345 48.345 0 0 1-5.781-32.589l1.534.921 51.722 29.826a8.339 8.339 0 0 0 8.441 0l63.181-36.425v25.221a.87.87 0 0 1-.358.665l-52.335 30.184c-23.257 13.398-52.97 5.431-66.404-17.803ZM23.549 85.38a48.499 48.499 0 0 1 25.58-21.333v61.39a8.288 8.288 0 0 0 4.195 7.316l62.874 36.272-21.845 12.636a.819.819 0 0 1-.767 0L41.353 151.53c-23.211-13.454-31.171-43.144-17.804-66.405v.256Zm179.466 41.695-63.08-36.63L161.73 77.86a.819.819 0 0 1 .768 0l52.233 30.184a48.6 48.6 0 0 1-7.316 87.635v-61.391a8.544 8.544 0 0 0-4.4-7.213Zm21.742-32.69-1.535-.922-51.619-30.081a8.39 8.39 0 0 0-8.492 0L99.98 99.808V74.587a.716.716 0 0 1 .307-.665l52.233-30.133a48.652 48.652 0 0 1 72.236 50.391v.205ZM88.061 139.097l-21.845-12.585a.87.87 0 0 1-.41-.614V65.685a48.652 48.652 0 0 1 79.757-37.346l-1.535.87-51.67 29.825a8.595 8.595 0 0 0-4.246 7.367l-.051 72.697Zm11.868-25.58 28.138-16.217 28.188 16.218v32.434l-28.086 16.218-28.188-16.218-.052-32.434Z"></path></svg></a><a href="https://claude.ai/new?q=%E6%88%91%E6%AD%A3%E5%9C%A8%E6%9F%A5%E7%9C%8B%20https://elysia.zhcndoc.com/blog/elysia-07.html%E3%80%82%0A%0A%E8%AF%B7%E6%82%A8%E8%A7%A3%E9%87%8A%E4%B8%80%E4%B8%8B%E8%BF%99%E4%B8%AA%E6%A6%82%E5%BF%B5%EF%BC%8C%E6%80%BB%E7%BB%93%E4%B8%80%E4%B8%8B%EF%BC%8C%E5%B9%B6%E5%9B%9E%E7%AD%94%E6%88%91%E5%85%B3%E4%BA%8E%E5%AE%83%E7%9A%84%E4%BB%BB%E4%BD%95%E9%97%AE%E9%A2%98%E5%A5%BD%E5%90%97%EF%BC%9F" class="clicky" target="_blank" rel="noopener noreferrer" title="Open in Claude"><svg fill-rule="evenodd" viewBox="0 0 24 24" fill="currentColor"><title>Anthropic</title><path d="M13.827 3.52h3.603L24 20h-3.603l-6.57-16.48zm-7.258 0h3.767L16.906 20h-3.674l-1.343-3.461H5.017l-1.344 3.46H0L6.57 3.522zm4.132 9.959L8.453 7.687 6.205 13.48H10.7z"></path></svg></a><a href="https://elysia.zhcndoc.com/blog/elysia-07.md" class="clicky" target="_blank" rel="noopener noreferrer" title="Open in Markdown"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-icon lucide-file"><path d="M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z"></path><path d="M14 2v5a1 1 0 0 0 1 1h5"></path></svg></a></div></div><!--]--><!--]--><!--]--><main class="main" data-v-7011f0d8><div style="position:relative;" class="vp-doc _blog_elysia-07" data-v-7011f0d8><div><!--[--><article id="blog" class="flex flex-col max-w-3xl w-full mx-auto mt-8"><a href="/blog" class="inline-flex items-center gap-2 text-base !text-gray-500 dark:!text-gray-400 !no-underline hover:!text-pink-500 focus:!text-pink-500 my-2 mr-auto"><span>←</span> Blog </a><h1 class="!text-3xl !md:text-4xl font-medium">Elysia 0.7 - Stellar Stellar</h1><aside class="flex gap-2 items-center mt-3"><img class="w-9 h-9 rounded-full" src="/blog/authors/lilith-happy.webp" alt="saltyaom"><div class="flex flex-col justify-start"><h3 class="!text-sm !m-0 opacity-75">saltyaom</h3><p class="flex flex-row items-center gap-2 !text-xs !m-0 opacity-75"><time datetime="2023 年 9 月 20 日">2023 年 9 月 20 日</time><span>ー</span><a href="https://twitter.com/saltyaom" target="_blank">@saltyaom</a></p></div></aside><img src="/blog/elysia-07/stellar-stellar.webp" alt="满天星斗的夜晚中的野外和山脉的风景" class="border w-full mt-5 mb-2"><main id="blog-content"><!--[--><p>以我们永不放弃的精神命名，献给我们心爱的虚拟 YouTuber，<s>Suicopath</s> 星街墨春，以及她那绝妙的声音：「<a href="https://youtu.be/AAsRtnbDs-0" target="_blank" rel="noreferrer">Stellar Stellar</a>」来自她的首张专辑：「Still Still Stellar」</p><p>曾经被遗忘，她确实是一颗在黑暗中闪耀的星星。</p><p><strong>Stellar Stellar</strong> 为 Elysia 带来了许多令人兴奋的新更新，帮助 Elysia 坚固基础，轻松处理复杂性，特点包括：</p><ul><li>全面重写类型，类型推断速度提高高达 13 倍。</li><li>用于声明式遥测和更好性能审计的“跟踪”。</li><li>反应式 Cookie 模型和 cookie 验证以简化 cookie 处理。</li><li>TypeBox 0.31 和自定义解码器的支持。</li><li>重写的 Web Socket 以获得更好的支持。</li><li>定义重映射和声明式后缀以防止名称冲突。</li><li>基于文本的状态</li></ul><h2 id="重写类型" tabindex="-1">重写类型 <a class="header-anchor" href="#重写类型" aria-label="Permalink to “重写类型”">​</a></h2><p>Elysia 的核心特征之一，关注开发者体验。</p><p>类型是 Elysia 最重要的方面之一，因为它使我们能够做很多令人惊叹的事情，比如统一类型、同步业务逻辑、打字、文档和前端。</p><p>我们希望您在 Elysia 上有出色的体验，专注于您的业务逻辑部分，让 Elysia 处理其余部分，无论是通过统一类型进行的类型推断，还是通过 Eden 连接器与后端同步类型。</p><p>为此，我们致力于创建一个统一的类型系统来同步所有类型，但随着功能的增长，我们发现我们的类型推断可能不够快速，因为我们几年前缺乏 TypeScript 的经验。</p><p>在处理复杂类型系统的过程中，我们积累了经验，进行了各种优化，参与了多个项目，如 <a href="https://github.com/saltyaom/mobius" target="_blank" rel="noreferrer">Mobius</a>。我们自我挑战再次加速我们的类型系统，使这成为 Elysia 的第二次类型重写。</p><p>我们从头开始删除并重写了每个 Elysia 类型，使 Elysia 类型的速度大幅提升。</p><p>这是 0.6 和 0.7 在简单的 <code>Elysia.get</code> 代码中的比较：</p><figure class="flex flex-row w-full max-w-full"><img alt="Elysia 0.6" style="width:50%;background:transparent;box-shadow:unset;" class="object-contain" src="/blog/elysia-07/type-0-6.webp"><img alt="Elysia 0.7" style="width:50%;background:transparent;box-shadow:unset;" class="object-contain" src="/blog/elysia-07/type-0-7.webp"></figure><p>凭借我们新获得的经验，以及像 const generic 这样的新版 TypeScript 特性，我们简化了许多代码，减少了代码库中一千多行的类型。</p><p>这使我们能够进一步优化我们的类型系统，使其速度更快、稳定性更高。</p><p><img src="/blog/elysia-07/inference-comparison.webp" alt="在我们的 300 条路由和 3,500 行类型声明的复杂项目中，Elysia 0.6 和 0.7 的比较" data-zoomable="true"></p><p>使用 Perfetto 和 TypeScript CLI 在一个大规模和复杂应用上生成跟踪，我们测量出了高达 13 倍的推断速度。</p><p>如果您想知道我们是否会在 0.6 中破坏类型推断，我们确实在类型级别上有单元测试，以确保大多数情况下没有破坏性更改。</p><p>我们希望这一改进能帮助您实现更快的类型推断，比如更快的自动完成，以及您 IDE 的加载时间接近瞬时，以帮助您的开发速度更快、更流畅。</p><h2 id="跟踪" tabindex="-1">跟踪 <a class="header-anchor" href="#跟踪" aria-label="Permalink to “跟踪”">​</a></h2><p>性能是 Elysia 另一个重要方面。</p><p>我们不想为了基准测试而快速，我们希望您在现实场景中拥有真正快速的服务器，而不仅仅是基准测试。</p><p>有许多因素可能会导致您的应用速度变慢，而且很难识别其中一个，这就是我们引入 <strong>“跟踪”</strong> 的原因。</p><p><strong>跟踪</strong> 允许我们利用生命周期事件，识别应用的性能瓶颈。</p><p><img src="/blog/elysia-07/trace.webp" alt="跟踪用法示例" data-zoomable="true"></p><p>这个示例代码允许我们插入所有 <strong>beforeHandle</strong> 事件，并逐个提取执行时间，然后设置 Server-Timing API 来检测性能瓶颈。</p><p>而且这不仅限于 <code>beforeHandle</code>，甚至 <code>handler</code> 本身的事件也可以被跟踪。命名约定是基于您已经熟悉的生命周期事件命名的。</p><p>此 API 使我们能够轻松审计 Elysia 服务器的性能瓶颈，并与您选择的报告工具集成。</p><p>默认情况下，跟踪使用 AoT 编译和动态代码注入来有条件地报告您实际使用的事件，这意味着不会对性能产生任何影响。</p><h2 id="反应式-cookie" tabindex="-1">反应式 Cookie <a class="header-anchor" href="#反应式-cookie" aria-label="Permalink to “反应式 Cookie”">​</a></h2><p>我们将我们的 cookie 插件合并到 Elysia 核心中。</p><p>与跟踪相同，反应式 Cookie 使用 AoT 编译和动态代码注入，条件性地注入 cookie 使用代码，如果您不使用它，则不会对性能产生影响。</p><p>反应式 Cookie 以更现代的方式使用信号来处理 cookie，并提供符合人体工程学的 API。</p><p><img src="/blog/elysia-07/cookie.webp" alt="反应式 Cookie 的使用示例" data-zoomable="true"></p><p>没有 <code>getCookie</code>、<code>setCookie</code>，一切皆是一个 cookie 对象。</p><p>当您想使用 cookie 时，只需提取名称并获取/设置其值，如下所示：</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ({ </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cookie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: { </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } }) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 获取</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    name.value</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 设置</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    name.value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;新值&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>然后 cookie 会自动将值与 headers 和 cookie 罐进行同步，使 <code>cookie</code> 对象成为处理 cookie 的单一真实来源。</p><p>Cookie 罐是反应式的，这意味着如果您没有为 cookie 设置新值，则不会发送 <code>Set-Cookie</code> 头，以保持相同的 cookie 值并减少性能瓶颈。</p><h3 id="cookie-架构" tabindex="-1">Cookie 架构 <a class="header-anchor" href="#cookie-架构" aria-label="Permalink to “Cookie 架构”">​</a></h3><p>随着 cookie 合并到 Elysia 核心中，我们引入了新的 <strong>Cookie 架构</strong>，用于验证 cookie 值。</p><p>当您需要严格验证 cookie 会话或希望对处理 cookie 提供严格的类型或类型推断时，这非常有用。</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ({ </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cookie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: { </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } }) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 设置</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    name.value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        id: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">617</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;召唤 101&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    cookie: t.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Cookie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        value: t.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            id: t.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Numeric</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            name: t.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>Elysia 自动为您编码和解码 cookie 值，因此如果您想将 JSON 存储在 cookie 中，例如解码的 JWT 值，或者只想确保值是数字字符串，您可以轻松做到这一点。</p><h3 id="cookie-签名" tabindex="-1">Cookie 签名 <a class="header-anchor" href="#cookie-签名" aria-label="Permalink to “Cookie 签名”">​</a></h3><p>最后，凭借 Cookie 架构的引入，以及 <code>t.Cookie</code> 类型。我们能够创建一种统一类型，以自动处理 cookie 签名的签名/验证。</p><p>Cookie 签名是附加到 cookie 值的加密哈希，使用密钥和 cookie 内容生成，以通过向 cookie 添加签名来增强安全性。</p><p>这确保 cookie 值未被恶意行为者修改，有助于验证 cookie 数据的真实性和完整性。</p><p>在 Elysia 中处理 cookie 签名，只需提供 <code>secret</code> 和 <code>sign</code> 属性：</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Elysia</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    cookie: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        secret: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Fischl von Luftschloss Narfidort&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ({ </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cookie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: { </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">profile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } }) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        profile.value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            id: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">617</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;召唤 101&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        cookie: t.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Cookie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            profile: t.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                id: t.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Numeric</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                name: t.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            sign: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;profile&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    })</span></span></code></pre></div><p>通过提供 cookie 密钥和 <code>sign</code> 属性来指示哪个 cookie 应进行签名验证。</p><p>Elysia 然后自动签署和取消签署 cookie 值，消除了手动调用 <strong>sign</strong> / <strong>unsign</strong> 函数的需要。</p><p>Elysia 自动处理 Cookie 的密钥轮换，因此如果您必须迁移到新的 cookie 密钥，只需附加密钥，Elysia 将使用第一个值来签署新 cookie，而在尝试与其余密钥签署的 cookie 时，如果匹配则取消签署。</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Elysia</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    cookie: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        secrets: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;复仇将属于我&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Fischl von Luftschloss Narfidort&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>反应式 Cookie API 是声明式和简单明了的，这里有一些关于它提供的符合人体工程学特性的神奇之处，我们非常期待您来尝试它。</p><h2 id="typebox-0-31" tabindex="-1">TypeBox 0.31 <a class="header-anchor" href="#typebox-0-31" aria-label="Permalink to “TypeBox 0.31”">​</a></h2><p>随着 0.7 的发布，我们正在更新到 TypeBox 0.31 为 Elysia 带来更多功能。</p><p>这带来了新兴的兴奋特性，如在 Elysia 中原生支持 TypeBox 的 <code>Decode</code>。</p><p>以前，一个像 <code>Numeric</code> 这样的自定义类型需要动态代码注入以将数字字符串转换为数字，但借助 TypeBox 的解码，我们允许定义一个自定义函数自动编码和解码类型的值。</p><p>这使我们能够将类型简化为：</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Numeric</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">property</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> NumericOptions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Type.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Transform</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Type.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Union</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([Type.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), Type.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(property)]))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Decode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">value</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isNaN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(number)) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> value</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> number</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Encode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> value) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> any</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> as</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> TNumber</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span></code></pre></div><p>不再依赖于广泛的检查和代码注入，而是通过 TypeBox 中的 <code>Decode</code> 函数实现简化。</p><p>我们已经重写了所有需要动态代码注入的类型，以使用 <code>Transform</code> 来简化代码维护。</p><p>不仅限于此，借助 <code>t.Transform</code>，您现在还可以定义一个自定义类型，手动指定自定义函数进行编码和解码，让您能够写出比以往任何时候都更加富有表现力的代码。</p><p>我们迫不及待想看看您在 <code>t.Transform</code> 引入后会带来什么。</p><h3 id="新类型" tabindex="-1">新类型 <a class="header-anchor" href="#新类型" aria-label="Permalink to “新类型”">​</a></h3><p>随着 <strong>Transform</strong> 的引入，我们新增了一种类型，如 <code>t.ObjectString</code>，用于自动解码请求中的对象值。</p><p>这在您必须使用 <strong>multipart/formdata</strong> 处理文件上传但不支持对象时非常有用。您现在只需使用 <code>t.ObjectString()</code> 来告诉 Elysia 该字段是串行化的 JSON，这样 Elysia 就可以自动解码。</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Elysia</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    cookie: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        secret: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Fischl von Luftschloss Narfidort&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">post</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ({ </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: { </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: { </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } } }) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> name, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        body: t.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            image: t.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">File</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            data: t.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ObjectString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                name: t.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    })</span></span></code></pre></div><p>我们希望这能简化对 JSON 和 <strong>multipart</strong> 的需求。</p><h2 id="重写-web-socket" tabindex="-1">重写 Web Socket <a class="header-anchor" href="#重写-web-socket" aria-label="Permalink to “重写 Web Socket”">​</a></h2><p>除了完全重写类型，我们还完全重写了 Web Socket。</p><p>以前我们发现 Web Socket 有 3 个主要问题：</p><ol><li>模式没有严格验证</li><li>类型推断慢</li><li>所有插件中需要 <code>.use(ws())</code></li></ol><p>通过这次更新，所有上述问题均得到了改善，同时提升了 Web Socket 的性能。</p><ol><li>现在，Elysia 的 Web Socket 是严格验证的，类型自动同步。</li><li>我们无需在每个插件中使用 <code>.use(ws())</code> 来使用 WebSocket。</li></ol><p>而且我们为已经快速的 Web Socket 带来了性能改进。</p><p>之前，Elysia Web Socket 需要处理每个传入请求的路由，以统一数据和上下文，但通过新模型，Web Socket 现在可以在不依赖于路由器的情况下推断其路由的数据。</p><p>将性能接近 Bun 原生 Web Socket 性能。</p><p>感谢 <a href="https://github.com/bogeychan" target="_blank" rel="noreferrer">Bogeychan</a> 提供测试用例，帮助我们自信地重写 Web Socket。</p><h2 id="定义重映射" tabindex="-1">定义重映射 <a class="header-anchor" href="#定义重映射" aria-label="Permalink to “定义重映射”">​</a></h2><p>在 <a href="https://github.com/elysiajs/elysia/issues/83" target="_blank" rel="noreferrer">#83</a> 中由 <a href="https://github.com/bogeychan" target="_blank" rel="noreferrer">Bogeychan</a> 提出的。</p><p>总结来说，Elysia 允许我们装饰请求并存储我们想要的任何值，然而某些插件可能与我们已有的值重复命名，而有时插件可能存在名称冲突，但我们根本无法重命名属性。</p><h3 id="重映射" tabindex="-1">重映射 <a class="header-anchor" href="#重映射" aria-label="Permalink to “重映射”">​</a></h3><p>字面意思是，这允许我们重映射现有的 <code>state</code>、<code>decorate</code>、<code>model</code>、<code>derive</code> 为我们希望的任何内容，以防止名称冲突，或者仅仅为了重命名属性。</p><p>通过提供一个函数作为第一个参数，回调将接受当前值，允许我们将其重映射为任何我们希望的值。</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Elysia</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        a: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;a&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        b: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;b&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    })</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 排除 b 状态</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(({ </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">rest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> rest)</span></span></code></pre></div><p>这在您必须处理具有某些重复名称的插件时非常有用，使您能够重映射插件的名称：</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Elysia</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        plugin</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">decorate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(({ </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">logger</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">rest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                pluginLogger: logger,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                ...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rest</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span></code></pre></div><p>重映射函数可以与 <code>state</code>、<code>decorate</code>、<code>model</code>、<code>derive</code> 一起使用，以帮助您定义正确的属性名称，并防止名称冲突。</p><h3 id="后缀" tabindex="-1">后缀 <a class="header-anchor" href="#后缀" aria-label="Permalink to “后缀”">​</a></h3><p>为了提供更顺畅的体验，一些插件可能有很多属性值，这会使逐一重映射变得令人不知所措。</p><p><strong>后缀</strong> 函数由一个 <strong>前缀</strong> 和 <strong>后缀</strong> 组成，允许我们重映射实例的所有属性，以防止插件的名称冲突。</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Elysia</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;setup&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">decorate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        argon: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;a&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        boron: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;b&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        carbon: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;c&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    })</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> app</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Elysia</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        setup</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">prefix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;decorator&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;setup&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ({ </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">setupCarbon</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> setupCarbon)</span></span></code></pre></div><p>这使我们能够轻松地批量重映射插件的属性，从而避免名称冲突。</p><p>默认情况下，<strong>后缀</strong> 将自动处理运行时和类型级代码，按照命名约定将属性重映射为驼峰式命名。</p><p>在某些情况下，您还可以重映射插件的 <code>所有</code> 属性：</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> app</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Elysia</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        setup</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">prefix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;all&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;setup&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ({ </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">setupCarbon</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> setupCarbon)</span></span></code></pre></div><p>我们希望重映射和后缀功能为您处理多个复杂插件提供强大的 API。</p><h2 id="真正的封装作用域" tabindex="-1">真正的封装作用域 <a class="header-anchor" href="#真正的封装作用域" aria-label="Permalink to “真正的封装作用域”">​</a></h2><p>随着 Elysia 0.7 的推出，Elysia 现在真正能够通过将作用域实例视为另一个实例来封装实例。</p><p>新的作用域模型甚至可以防止事件如 <code>onRequest</code> 在主实例上解析，这是不可能的。</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> plugin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Elysia</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ scoped: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, prefix: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/hello&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">onRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;在作用域中&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;你好&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> app</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Elysia</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(plugin)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // &#39;在作用域中&#39; 不会日志输出</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Hello World&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>更重要的是，作用域现在在运行时和类型级别上都是真正限制的，这是之前没有类型重写时无法实现的。</p><p>这对维护者来说令人兴奋，因为之前，真正封装一个实例的作用域几乎是不可能的，但通过使用 <code>mount</code> 和 WinterCG 的一致性，我们终于能够真正封装插件的实例，同时与主实例的属性如 <code>state</code>、<code>decorate</code> 之间提供软连接。</p><h2 id="基于文本的状态" tabindex="-1">基于文本的状态 <a class="header-anchor" href="#基于文本的状态" aria-label="Permalink to “基于文本的状态”">​</a></h2><p>有超过 64 个标准 HTTP 状态码需要记忆，我承认有时我们也会忘记我们想要使用的状态。</p><p>这就是为什么我们以文本形式提供 64 个 HTTP 状态码，并为您提供自动完成功能。</p><p><img src="/blog/elysia-07/teapot.webp" alt="基于文本的状态码使用示例" data-zoomable="true"></p><p>文本将自动解析为状态码，如预期的那样。</p><p>当您输入时，IDE 会自动弹出关于文本的自动完成功能，无论是 NeoVim 还是 VSCode，因为这是 TypeScript 的内置功能。</p><p><img src="/blog/elysia-07/teapot-autocompletion.webp" alt="基于文本的状态码显示自动完成" data-zoomable="true"></p><p>这是一个小的符合人体工程学的功能，帮助您开发服务器，而无需在 IDE 和 MDN 之间切换以查找正确的状态码。</p><h2 id="显著改进" tabindex="-1">显著改进 <a class="header-anchor" href="#显著改进" aria-label="Permalink to “显著改进”">​</a></h2><p>改进：</p><ul><li><code>onRequest</code> 现在可以是异步的</li><li>将 <code>Context</code> 添加到 <code>onError</code></li><li>生命周期钩子现在接受数组函数</li><li>静态代码分析现在支持 rest 参数</li><li>将动态路由分解为单个流水线，而不是内联到静态路由中，以减少内存使用</li><li>将 <code>t.File</code> 和 <code>t.Files</code> 设置为 <code>File</code> 而不是 <code>Blob</code></li><li>跳过类实例合并</li><li>处理 <code>UnknownContextPassToFunction</code></li><li><a href="https://github.com/elysiajs/elysia/pull/179" target="_blank" rel="noreferrer">#157</a> WebSocket - 添加单元测试并修复示例和 API 由 @bogeychan 提供</li><li><a href="https://github.com/elysiajs/elysia/pull/179" target="_blank" rel="noreferrer">#179</a> 添加 GitHub 行动以运行 bun 测试由 @arthurfiorette 提供</li></ul><p>破坏性更改：</p><ul><li>移除 <code>ws</code> 插件，迁移到核心</li><li>将 <code>addError</code> 重命名为 <code>error</code></li></ul><p>变更：</p><ul><li>使用单个 findDynamicRoute，而不是内联到静态映射</li><li>移除 <code>mergician</code></li><li>由于 TypeScript 问题，移除数组路由</li><li>重写 Type.ElysiaMeta 以使用 TypeBox.Transform</li></ul><p>错误修复：</p><ul><li>默认严格验证响应</li><li><code>t.Numeric</code> 在 headers / query / params 中不工作</li><li><code>t.Optional(t.Object({ [name]: t.Numeric }))</code> 导致错误</li><li>在转换 <code>Numeric</code> 之前添加 null 检查</li><li>从实例插件中继承存储</li><li>处理类重叠</li><li><a href="https://github.com/elysiajs/elysia/pull/187" target="_blank" rel="noreferrer">#187</a> InternalServerError 消息修复为 &quot;INTERNAL_SERVER_ERROR&quot;，而不是 &quot;NOT_FOUND&quot;，由 @bogeychan 提供</li><li><a href="https://github.com/elysiajs/elysia/pull/167" target="_blank" rel="noreferrer">#167</a> mapEarlyResponse 在处理后带有 aot</li></ul><h2 id="之后" tabindex="-1">之后 <a class="header-anchor" href="#之后" aria-label="Permalink to “之后”">​</a></h2><p>自最新发布以来，我们在 GitHub 上获得了超过 2,000 个星星！</p><p>回顾过去，我们的进步超乎我们的想象。</p><p>推动 TypeScript 和开发者体验的边界，甚至使我们感到做了一些真正深刻的事情。</p><p>随着每次发布，我们逐渐朝着实现我们很久以来描绘的未来迈出了一步。</p><p>一个我们可以自由创造任何想要的东西，同时拥有惊人的开发者体验的未来。</p><p>我们真心感谢您和可爱的 TypeScript 和 Bun 社区的爱与支持。</p><p>看到 Elysia 由像以下这样出色的开发者们赋予生命，真是令人兴奋：</p><ul><li><a href="https://youtu.be/aDYYn9R-JyE?si=hgvGgbywu_-jsmhR" target="_blank" rel="noreferrer">Ethan Niser 和他令人惊叹的 BETH Stack</a></li><li>被 <a href="https://youtu.be/dWqNgzZwVJQ?si=AeCmcMsTZtNwmhm2" target="_blank" rel="noreferrer">Fireship</a> 提及</li><li>有 <a href="https://github.com/pilcrowOnPaper/lucia" target="_blank" rel="noreferrer">Lucia Auth</a> 的官方集成</li></ul><p>以及更多选择 Elysia 作为下一个项目的开发者。</p><p>我们的目标很简单，为您营造一个您可以追求梦想的永恒乐园，让每个人都能快乐地生活。</p><p>感谢您和您对 Elysia 的爱与支持，我们希望有一天将我们的梦想描绘成现实。</p><p><strong>愿所有美好事物都被祝福</strong></p><blockquote><p>伸出那只手，好像想要触碰某人</p><p>我和你一样，没什么特别</p><p>没错，我会唱夜晚的歌</p><p>Stellar Stellar</p><p>在世界的中心，宇宙中</p><p>音乐今晚将永不停歇</p><p>没错，我总是渴望成为</p><p>不是仙履奇缘，永远等待</p><p>而是她所渴望的王子</p><p>因为我是一颗星，因此</p><p>Stellar Stellar</p></blockquote><!--]--></main><a href="/" class="inline-flex items-center gap-2 text-base !text-gray-500 dark:!text-gray-400 !no-underline hover:!text-pink-500 focus:!text-pink-500 mt-2 mr-auto"><span>←</span> Elysia: Ergonomic Framework for Humans </a></article><!----><!--]--></div></div></main><footer class="VPDocFooter" data-v-7011f0d8 data-v-e257564d><!--[--><!--]--><div class="edit-info" data-v-e257564d><!----><div class="last-updated" data-v-e257564d><p class="VPLastUpdated" data-v-e257564d data-v-3c637f39>最后更新于: <time datetime="2026-01-11T07:34:37.000Z" data-v-3c637f39></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><!----></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/at-glance.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>下一页</span><span class="title" data-v-e257564d>概览</span><!--]--></a></div></nav></footer><!--[--><!--[--><!--[--><div className="relative mt-4 w-full rounded-md border border-gray-950/5 p-2 dark:border-white/10"><a href="https://www.rainyun.com/mm_?s=zhcndoc" target="_blank" className="absolute inset-0 z-10" data-umami-event="ads-rainyun"></a><div className="flex w-full justify-center"><img src="/ads/rainyun_2.png" className="w-full rounded-sm"></div></div><!--]--><!--]--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"at-glance.md\":\"cWzR3aEv\",\"blog.md\":\"BUWTAt4q\",\"blog_elysia-02.md\":\"HcaF_VLR\",\"blog_elysia-03.md\":\"CoYxt_iD\",\"blog_elysia-04.md\":\"CgZIxbT3\",\"blog_elysia-05.md\":\"cB-sDRd7\",\"blog_elysia-06.md\":\"DSUtJZcP\",\"blog_elysia-07.md\":\"DKoM3KRH\",\"blog_elysia-08.md\":\"CJusyZv2\",\"blog_elysia-10.md\":\"DxpwI3_c\",\"blog_elysia-11.md\":\"CNM7X7Mf\",\"blog_elysia-12.md\":\"CZj_W4OZ\",\"blog_elysia-13.md\":\"CaZy0WoQ\",\"blog_elysia-14.md\":\"D39ggO1l\",\"blog_elysia-supabase.md\":\"CrNOi5Gh\",\"blog_elysia-v-encore.md\":\"5FFmj1m_\",\"blog_openapi-type-gen.md\":\"BOaQGPpN\",\"blog_with-prisma.md\":\"CgRVvmDH\",\"eden_fetch.md\":\"84mMicXY\",\"eden_installation.md\":\"BI5bjmX_\",\"eden_overview.md\":\"CCwYNV7P\",\"eden_test.md\":\"DQ-_pchS\",\"eden_treaty_config.md\":\"CkFgVn8n\",\"eden_treaty_legacy.md\":\"BvCBfsGv\",\"eden_treaty_overview.md\":\"B1EaKzPx\",\"eden_treaty_parameters.md\":\"BYBDGS9x\",\"eden_treaty_response.md\":\"CuOYLCmT\",\"eden_treaty_unit-test.md\":\"N57AzLyj\",\"eden_treaty_websocket.md\":\"DigpWSGk\",\"essential_best-practice.md\":\"Cd1qIPWA\",\"essential_handler.md\":\"BU2sz3EC\",\"essential_life-cycle.md\":\"DG7LrGyP\",\"essential_plugin.md\":\"Crq4sAKe\",\"essential_route.md\":\"BoZUieSG\",\"essential_validation.md\":\"D59EbSJ3\",\"illust.md\":\"C3vSwf7R\",\"index.md\":\"N_HVpFuD\",\"integrations_ai-sdk.md\":\"HIS5SNa7\",\"integrations_astro.md\":\"qAkBEk-c\",\"integrations_better-auth.md\":\"NRsnJcap\",\"integrations_cheat-sheet.md\":\"CP9eMGXo\",\"integrations_cloudflare-worker.md\":\"BEbWzrlo\",\"integrations_deno.md\":\"BfeIoiNI\",\"integrations_drizzle.md\":\"q6r6Pvsx\",\"integrations_expo.md\":\"BRTea-_v\",\"integrations_netlify.md\":\"BJ7oZ1K6\",\"integrations_nextjs.md\":\"Dgau1vaw\",\"integrations_node.md\":\"C2hPMDDz\",\"integrations_nuxt.md\":\"BpwVB95s\",\"integrations_prisma.md\":\"qQZwfF6G\",\"integrations_react-email.md\":\"DViI09yT\",\"integrations_sveltekit.md\":\"DQ9DHS--\",\"integrations_tanstack-start.md\":\"DkmTVvZ4\",\"integrations_vercel.md\":\"Co_zjnV5\",\"key-concept.md\":\"Dv_U434E\",\"migrate_from-express.md\":\"QBVXowWA\",\"migrate_from-fastify.md\":\"DjxSchX_\",\"migrate_from-hono.md\":\"Dw0HGOww\",\"migrate_from-trpc.md\":\"D_fU-iI3\",\"migrate_index.md\":\"CN05lqci\",\"patterns_configuration.md\":\"ByogGe3j\",\"patterns_cookie.md\":\"Bm-71ePa\",\"patterns_deploy.md\":\"B8v-XMGl\",\"patterns_error-handling.md\":\"Bn3i_ZLU\",\"patterns_extends-context.md\":\"BkhM9bQC\",\"patterns_fullstack-dev-server.md\":\"CHLwDeVL\",\"patterns_macro.md\":\"C6ZFQXmU\",\"patterns_mount.md\":\"TDg2Ad2w\",\"patterns_openapi.md\":\"BDdUn0Hv\",\"patterns_opentelemetry.md\":\"DISHe3Rz\",\"patterns_trace.md\":\"C2kODuLQ\",\"patterns_typebox.md\":\"BPf8PaCO\",\"patterns_typescript.md\":\"DmbikXBb\",\"patterns_unit-test.md\":\"BhCCQad4\",\"patterns_websocket.md\":\"CpSQJgR8\",\"playground_index.md\":\"DZT0B_6C\",\"playground_preview.md\":\"C3X4aVtx\",\"plugins_bearer.md\":\"Cm0j5JHp\",\"plugins_cors.md\":\"CiKZYicw\",\"plugins_cron.md\":\"Dwl7_TU7\",\"plugins_graphql-apollo.md\":\"Dcf4SZjK\",\"plugins_graphql-yoga.md\":\"BC6JAVMx\",\"plugins_html.md\":\"Cf7SVbP9\",\"plugins_jwt.md\":\"BN9QkQRo\",\"plugins_openapi.md\":\"DHGoujnC\",\"plugins_opentelemetry.md\":\"Dv7ODqSK\",\"plugins_overview.md\":\"5d1C94KL\",\"plugins_server-timing.md\":\"t-wITrcD\",\"plugins_static.md\":\"CM8Oif_y\",\"plugins_swagger.md\":\"CSbs4ssw\",\"quick-start.md\":\"CDc3RZ5I\",\"table-of-content.md\":\"CWDosMkg\",\"tutorial_features_end-to-end-type-safety_index.md\":\"2JLeosg4\",\"tutorial_features_mount_index.md\":\"BlJeCcuy\",\"tutorial_features_openapi_index.md\":\"DNxBUEkD\",\"tutorial_features_unit-test_index.md\":\"UKieC_cs\",\"tutorial_getting-started_encapsulation_index.md\":\"ClmXlQAS\",\"tutorial_getting-started_guard_index.md\":\"B9z-gFFD\",\"tutorial_getting-started_handler-and-context_index.md\":\"CFzIix7V\",\"tutorial_getting-started_life-cycle_index.md\":\"BrAYcjL4\",\"tutorial_getting-started_plugin_index.md\":\"B_PH2v9n\",\"tutorial_getting-started_status-and-headers_index.md\":\"XnQJkKG-\",\"tutorial_getting-started_validation_index.md\":\"D-WWHqe6\",\"tutorial_getting-started_your-first-route_index.md\":\"BAkY6O0n\",\"tutorial_index.md\":\"Crxrxkdp\",\"tutorial_patterns_cookie_index.md\":\"BfZemszS\",\"tutorial_patterns_error-handling_index.md\":\"CJ3G1BeR\",\"tutorial_patterns_extends-context_index.md\":\"8CzvweM3\",\"tutorial_patterns_macro_index.md\":\"DqbvAcGH\",\"tutorial_patterns_standalone-schema_index.md\":\"DdVHiMv1\",\"tutorial_patterns_validation-error_index.md\":\"D4H-Pa3e\",\"tutorial_whats-next.md\":\"3FRzFYsT\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"zh-CN\",\"dir\":\"ltr\",\"title\":\"Elysia 中文文档\",\"titleTemplate\":\":title - Elysia 中文文档\",\"description\":\"适合人体工程学的框架，由 Bun 强化的 TypeScript 框架，具有端到端的类型安全、统一的类型系统和卓越的开发者体验。\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"search\":{\"provider\":\"local\",\"options\":{\"detailedView\":true,\"locales\":{\"root\":{\"translations\":{\"button\":{\"buttonText\":\"搜索文档\",\"buttonAriaLabel\":\"搜索文档\"},\"modal\":{\"noResultsText\":\"无法找到相关结果\",\"resetButtonTitle\":\"清除查询条件\",\"footer\":{\"selectText\":\"选择\",\"navigateText\":\"切换\"}}}}}}},\"logo\":\"/assets/elysia.svg\",\"nav\":[{\"text\":\"文档\",\"link\":\"/table-of-content\"},{\"text\":\"博客\",\"link\":\"/blog\"},{\"text\":\"Illust\",\"link\":\"/illust\"}],\"sidebar\":[{\"text\":\"入门\",\"collapsed\":true,\"items\":[{\"text\":\"概览\",\"link\":\"/at-glance\"},{\"text\":\"快速开始\",\"link\":\"/quick-start\"},{\"text\":\"目录\",\"link\":\"/table-of-content\"},{\"text\":\"关键概念\",\"link\":\"/key-concept\"}]},{\"text\":\"基础\",\"collapsed\":true,\"items\":[{\"text\":\"路由\",\"link\":\"/essential/route\"},{\"text\":\"处理程序\",\"link\":\"/essential/handler\"},{\"text\":\"插件\",\"link\":\"/essential/plugin\"},{\"text\":\"生命周期\",\"link\":\"/essential/life-cycle\"},{\"text\":\"验证\",\"link\":\"/essential/validation\"},{\"text\":\"最佳实践\",\"link\":\"/essential/best-practice\"}]},{\"text\":\"模式\",\"collapsed\":true,\"items\":[{\"text\":\"配置\",\"link\":\"/patterns/configuration\"},{\"text\":\"Cookie\",\"link\":\"/patterns/cookie\"},{\"text\":\"生产环境部署\",\"link\":\"/patterns/deploy\"},{\"text\":\"错误处理\",\"link\":\"/patterns/error-handling\"},{\"text\":\"扩展上下文\",\"link\":\"/patterns/extends-context\"},{\"text\":\"Fullstack Dev Server\",\"link\":\"/patterns/fullstack-dev-server\"},{\"text\":\"Macro\",\"link\":\"/patterns/macro\"},{\"text\":\"挂载\",\"link\":\"/patterns/mount\"},{\"text\":\"OpenAPI\",\"link\":\"/patterns/openapi\"},{\"text\":\"OpenTelemetry\",\"link\":\"/patterns/opentelemetry\"},{\"text\":\"Trace\",\"link\":\"/patterns/trace\"},{\"text\":\"TypeBox (Elysia.t)\",\"link\":\"/patterns/typebox\"},{\"text\":\"TypeScript\",\"link\":\"/patterns/typescript\"},{\"text\":\"单元测试\",\"link\":\"/patterns/unit-test\"},{\"text\":\"WebSocket\",\"link\":\"/patterns/websocket\"}]},{\"text\":\"Eden\",\"collapsed\":true,\"items\":[{\"text\":\"概述\",\"link\":\"/eden/overview.md\"},{\"text\":\"安装\",\"link\":\"/eden/installation.md\"},{\"text\":\"Eden 协议\",\"collapsed\":false,\"items\":[{\"text\":\"概述\",\"link\":\"/eden/treaty/overview\"},{\"text\":\"参数\",\"link\":\"/eden/treaty/parameters\"},{\"text\":\"响应\",\"link\":\"/eden/treaty/response\"},{\"text\":\"WebSocket\",\"link\":\"/eden/treaty/websocket\"},{\"text\":\"配置\",\"link\":\"/eden/treaty/config\"},{\"text\":\"单元测试\",\"link\":\"/eden/treaty/unit-test\"},{\"text\":\"旧版（协议 1）\",\"link\":\"/eden/treaty/legacy.md\"}]},{\"text\":\"Eden Fetch\",\"link\":\"/eden/fetch.md\"}]},{\"text\":\"插件\",\"collapsed\":true,\"items\":[{\"text\":\"概述\",\"link\":\"/plugins/overview\"},{\"text\":\"Bearer\",\"link\":\"/plugins/bearer\"},{\"text\":\"CORS\",\"link\":\"/plugins/cors\"},{\"text\":\"Cron\",\"link\":\"/plugins/cron\"},{\"text\":\"GraphQL Apollo\",\"link\":\"/plugins/graphql-apollo\"},{\"text\":\"GraphQL Yoga\",\"link\":\"/plugins/graphql-yoga\"},{\"text\":\"HTML\",\"link\":\"/plugins/html\"},{\"text\":\"JWT\",\"link\":\"/plugins/jwt\"},{\"text\":\"OpenAPI\",\"link\":\"/plugins/openapi\"},{\"text\":\"OpenTelemetry\",\"link\":\"/plugins/opentelemetry\"},{\"text\":\"服务器计时\",\"link\":\"/plugins/server-timing\"},{\"text\":\"静态\",\"link\":\"/plugins/static\"}]},{\"text\":\"比较\",\"collapsed\":true,\"items\":[{\"text\":\"Express\",\"link\":\"/migrate/from-express\"},{\"text\":\"Fastify\",\"link\":\"/migrate/from-fastify\"},{\"text\":\"Hono\",\"link\":\"/migrate/from-hono\"},{\"text\":\"tRPC\",\"link\":\"/migrate/from-trpc\"}]},{\"text\":\"集成\",\"collapsed\":true,\"items\":[{\"text\":\"AI SDK\",\"link\":\"/integrations/ai-sdk\"},{\"text\":\"Astro\",\"link\":\"/integrations/astro\"},{\"text\":\"Better Auth\",\"link\":\"/integrations/better-auth\"},{\"text\":\"Cloudflare Worker\",\"link\":\"/integrations/cloudflare-worker\"},{\"text\":\"Deno\",\"link\":\"/integrations/deno\"},{\"text\":\"Drizzle\",\"link\":\"/integrations/drizzle\"},{\"text\":\"Expo\",\"link\":\"/integrations/expo\"},{\"text\":\"Netlify\",\"link\":\"/integrations/netlify\"},{\"text\":\"Nextjs\",\"link\":\"/integrations/nextjs\"},{\"text\":\"Node.js\",\"link\":\"/integrations/node\"},{\"text\":\"Nuxt\",\"link\":\"/integrations/nuxt\"},{\"text\":\"Prisma\",\"link\":\"/integrations/prisma\"},{\"text\":\"React Email\",\"link\":\"/integrations/react-email\"},{\"text\":\"SvelteKit\",\"link\":\"/integrations/sveltekit\"},{\"text\":\"Tanstack Start\",\"link\":\"/integrations/tanstack-start\"},{\"text\":\"Vercel\",\"link\":\"/integrations/vercel\"}]}],\"outline\":{\"level\":[2,3],\"label\":\"目录\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/elysiajs/elysia\"},{\"icon\":\"twitter\",\"link\":\"https://twitter.com/elysiajs\"},{\"icon\":\"discord\",\"link\":\"https://discord.gg/eaFJ2KDJck\"}],\"editLink\":{\"text\":\"在 GitHub 上编辑此页面\",\"pattern\":\"https://github.com/zhcndoc/elysia/tree/main/docs/:path\"},\"docFooter\":{\"prev\":\"上一页\",\"next\":\"下一页\"},\"lastUpdated\":{\"text\":\"最后更新于\",\"formatOptions\":{\"dateStyle\":\"short\",\"timeStyle\":\"medium\"}},\"langMenuLabel\":\"多语言\",\"returnToTopLabel\":\"回到顶部\",\"sidebarMenuLabel\":\"菜单\",\"darkModeSwitchLabel\":\"主题\",\"lightModeSwitchTitle\":\"切换到浅色模式\",\"darkModeSwitchTitle\":\"切换到深色模式\"},\"locales\":{\"root\":{\"label\":\"简体中文\",\"lang\":\"zh\"},\"en\":{\"label\":\"English\",\"lang\":\"en\",\"link\":\"https://elysiajs.com/\"}},\"scrollOffset\":134,\"cleanUrls\":false,\"additionalConfig\":{}}");</script>
    
  </body>
</html>