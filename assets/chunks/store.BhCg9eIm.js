const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunks/monaco.CigHtxZ-.js","assets/chunks/monaco.CNtVI30n.js","assets/chunks/preload-helper.CPrT4D5T.js","assets/chunks/chunk.BqXodU4U.js","assets/chunks/utils.Btv7ixBe.js","assets/chunks/editor.api.BnhLjnoq.js","assets/chunks/monaco.contribution.DnUq578-.js"])))=>i.map(i=>d[i]);
import{P as e}from"./vue.runtime.esm-bundler.BB7fvrom.js";import{n as t}from"./pinia.BlUWc_69.js";import{n,t as r}from"./preload-helper.CPrT4D5T.js";import{t as i}from"./dist.CgqBDwnI.js";import{n as a,r as o}from"./utils.Btv7ixBe.js";var s=()=>(location.pathname.endsWith(`/`)?location.pathname.slice(0,-1):location.pathname).replace(/.html$/g,``);const c={fs:()=>`elysia-playground:fs:${s()}`,path:()=>`elysia-playground:path:${s()}`,method:()=>`elysia-playground:method:${s()}`,body:()=>`elysia-playground:body:${s()}`,headers:()=>`elysia-playground:headers:${s()}`,cookies:()=>`elysia-playground:cookies:${s()}`};function l({fs:e,path:t,method:n,body:r,headers:i,cookies:a}){e!==void 0&&localStorage.setItem(c.fs(),JSON.stringify(e)),t!==void 0&&localStorage.setItem(c.path(),t),n!==void 0&&localStorage.setItem(c.method(),n),r!==void 0&&localStorage.setItem(c.body(),r),i!==void 0&&localStorage.setItem(c.headers(),JSON.stringify(i)),a!==void 0&&localStorage.setItem(c.cookies(),JSON.stringify(a))}function u(e){if(typeof localStorage>`u`)return;let t=localStorage.getItem(c[e]());if(t){if(e===`fs`||e===`headers`||e===`cookies`)try{return JSON.parse(t)}catch{if(e===`fs`&&t){let e=localStorage.getItem(`elysia-playground:code:${s()}`);if(e)return{"index.ts":e}}return}return t}}n();var d=i(),f,p=()=>Math.random().toString(36).substring(2),m=e=>Object.entries(e).map(([e,t])=>(0,d.serialize)(e,t)).join(`; `);function h(e,t){if(typeof e!=`object`||typeof t!=`object`||e===null||t===null)return e===t;let n=Object.keys(e),r=Object.keys(t);for(let i of n)if(!r.includes(i)||!h(e[i],t[i]))return!1;return!0}function g(e){if(!e)return{};let t={};for(let[n,r]of e)n&&(t[n]=r);return t}const _=t(`playground`,{state:()=>({id:p(),fs:{"index.ts":``},defaultFS:{"index.ts":``},tabs:{active:0,files:[`index.ts`]},doc:`/`,theme:`light`,input:{path:`/`,method:`GET`,body:``,headers:[],cookie:[]},response:{body:null,status:null,headers:{}},result:{console:[],error:null,isHTML:!1},tab:{aside:`task`,result:`preview`},testcases:[],testcasesResult:[]}),getters:{activeFile:e=>e.tabs.files[e.tabs.active]},actions:{createNewFile(){let e=`${this.tabs.files.length}.ts`;this.tabs.files.push(e),this.fs[e]=``,this.tabs.active=this.tabs.files.length-1},load(){if(typeof window>`u`)return;let e={fs:u(`fs`),body:u(`body`),headers:u(`headers`),cookies:u(`cookies`),method:u(`method`),path:u(`path`)};e.fs===void 0?this.fs=this.defaultFS:this.fs=e.fs,e.path!==void 0&&(this.input.path=e.path),e.method!==void 0&&(this.input.method=e.method),e.body!==void 0&&(this.input.body=e.body),e.headers!==void 0&&(this.input.headers=e.headers),e.cookies!==void 0&&(this.input.cookie=e.cookies);let t=localStorage.getItem(`vitepress-theme-appearance`);(t===`light`||t===`dark`)&&(this.theme=t),t===`dark`?document.documentElement.classList.add(`dark`):document.documentElement.classList.remove(`dark`)},save(){typeof window>`u`||l({fs:this.fs,path:this.input.path,body:this.input.body,headers:this.input.headers,cookies:this.input.cookie,method:this.input.method})},async syncEditorTheme(){let{updateTheme:e}=await r(async()=>{let{updateTheme:e}=await import(`./monaco.CigHtxZ-.js`);return{updateTheme:e}},__vite__mapDeps([0,1,2,3,4,5,6]));e(this.theme)},setTheme(e){return e||=this.theme===`light`?`dark`:`light`,this.theme=e,localStorage.setItem(`vitepress-theme-appearance`,e),e===`dark`?document.documentElement.classList.add(`dark`):document.documentElement.classList.remove(`dark`),this.syncEditorTheme()},reset(){this.fs=this.defaultFS,window.location.reload()},async setThemeWithAnimation(t){if(typeof window>`u`)return;if(!(()=>`startViewTransition`in document&&window.matchMedia(`(prefers-reduced-motion: no-preference)`).matches)()||!window?.localStorage){this.setTheme(t);return}let n=window.localStorage.getItem(`theme-switch`);if(n!==null&&!isNaN(+n)){let e=+n;Date.now()-e>180*1e3?document.documentElement.classList.contains(`-animated`)&&document.documentElement.classList.remove(`-animated`):document.documentElement.classList.add(`-animated`)}window.localStorage.setItem(`theme-switch`,Date.now().toString()),document.startViewTransition!==void 0&&await document.startViewTransition(async()=>{await this.setTheme(t),await e()}).ready;let{updateTheme:i}=await r(async()=>{let{updateTheme:e}=await import(`./monaco.CigHtxZ-.js`);return{updateTheme:e}},__vite__mapDeps([0,1,2,3,4,5,6]));i(this.theme)},async run({test:e=!1}={}){let t=p();this.id=t,this.result.error=null;let n=!1,r=!e;f=setTimeout(()=>{this.id===t&&(this.response.body=null,this.response.status=null,this.response.headers={},n||(this.result.console=[]),r||(this.testcasesResult=Array(this.testcases.length).fill(!1)))},300);let i={headers:g(this.input.headers),cookie:g(this.input.cookie)};try{let s=m({...i.cookie,...i.headers.cookie?(0,d.parse)(i.headers.cookie):{}}),[c,{headers:l,status:u}]=await a(this.fs,`https://elysiajs.com${this.input.path}`,{method:this.input.method,headers:Object.assign(o(this.input.body)?{"content-type":`application/json`}:this.input.body.trim()?{"content-type":`text/plain`}:{},i.headers,s?{"x-browser-cookie":s}:{}),body:this.input.body&&this.input.method!==`GET`&&this.input.method!==`HEAD`?this.input.body:void 0},e=>{if(this.id===t){n||(n=!0,this.result.console=[]);for(let t of e)this.result.console.push({data:typeof t==`object`?JSON.stringify(t,null,2):t+``,time:Date.now()})}});if(this.id!==t)return;clearTimeout(f),requestAnimationFrame(this.save),this.response.body=c,this.response.headers=l,this.response.status=u??null;let p=document.getElementById(`preview-sandbox`);if(this.result.isHTML=/<[^>]+>/.test(c),localStorage.setItem(`elysia-playground:preview`,c),this.result.isHTML&&p&&p.contentWindow&&p.contentWindow.location.reload(),e){this.testcasesResult.length!==this.testcases.length&&(this.testcasesResult=Array(this.testcases.length).fill(!1));let e=await Promise.all(this.testcases.map(async({test:e})=>{Array.isArray(e)||(e=[e]);for(let{request:n,response:r}of e){let e=m({...n.cookie,...n.headers?.cookie?(0,d.parse)(n.headers.cookie):{}}),[i,{headers:o,status:s}]=await a(this.fs,`https://elysiajs.com${n.url}`,{body:n.body&&typeof n.body==`object`?JSON.stringify(n.body):n.method!==`GET`&&n.method!==`HEAD`?n.body:void 0,method:n.method??`GET`,headers:Object.assign(n.body?typeof n.body==`object`?{"content-type":`application/json`}:typeof n.body==`string`?{"content-type":`text/plain`}:{}:{},{...n.headers},e?{"x-browser-cookie":e}:{})});if(this.id!==t)return!1;if(r.body){if(typeof r.body==`object`)try{if(!h(r.body,JSON.parse(i)))return!1}catch{return!1}else if(typeof r.body==`function`&&!r.body(i))return!1;else if(typeof r.body!=`function`&&r.body!==i)return!1}if(r.status!==void 0&&(typeof r.status==`function`?!r.status(s):r.status!==s))return!1;if(r.headers){for(let[e,t]of Object.entries(r.headers))if(typeof t==`function`){if(t(o[e]))continue;return!1}else if(t!==o[e])return!1}}return!0}));r=!0,this.testcasesResult=e}}catch(e){let t=e;t&&(this.result.error=t.syntax?.stack??t.stack?.message??t.stack??t.message??t+``)}}}});export{_ as t};