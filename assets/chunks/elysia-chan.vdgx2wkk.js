import{C as e,Ct as t,Dt as n,L as r,T as i,V as a,_ as o,b as s,dt as c,g as l,gt as u,it as d,tt as f,z as p}from"./vue.runtime.esm-bundler.BB7fvrom.js";import{S as m,h,t as g,x as _}from"./motion.DQ6fBwSb.js";function v(e){let t=0,n=({timestamp:n,delta:r})=>{t||=n,e(n-t,r)},i=()=>_(n);r(()=>{i(),m.update(n,!0)}),p(()=>i()),m.update(n,!0)}var y=`/elysia/sprite/face.webp`,b=`/elysia/sprite/body.webp`,x={className:`relative isolate w-full h-full`},S=.5,C=i({__name:`elysia-chan`,setup(r){let i=u(),m={stand:0,walk:1,sit:2},_={normal:0,happy:1,xd:2},C={[m.stand]:32.2,[m.walk]:32.6,[m.sit]:39.8},w={[_.normal]:1.2,[_.happy]:0,[_.xd]:0},T=u({face:!1,body:!1}),E=u({body:m.stand,face:_.normal,side:`left`}),D=l(()=>C[E.value.body]+w[E.value.face]),O=h(0),k=u(0),A=u(!0),j=u({walk:!1,face:!1}),M=(e,t)=>Math.floor(Math.random()*(t-e+1))+e,N,P,F;f(()=>T.value,e=>{!e.body||!e.face||L()},{deep:!0,immediate:!0});function I(){clearInterval(N),clearInterval(P),clearTimeout(F),localStorage.setItem(`elysia-chan:x`,O.get()+``),localStorage.setItem(`elysia-chan:sit`,A.value?`true`:`false`),localStorage.setItem(`elysia-chan:walkTo`,k.value+``)}function L(){let e=window.innerWidth-100,t=e,n=+(localStorage.getItem(`elysia-chan:x`)||0);O.set(!isNaN(n)&&n<e&&n>0?n:window.innerWidth-100);let r=+(localStorage.getItem(`elysia-chan:walkTo`)||0);k.value=!isNaN(r)&&r<t&&r>0?r:t,(A.value=localStorage.getItem(`elysia-chan:sit`)===`true`)&&(E.value.body=m.sit),N=setInterval(()=>{if(!A.value){if(O.get()===k.value){E.value.body===m.walk&&(E.value.body=m.stand);return}E.value.body=E.value.body===m.stand?m.walk:m.stand}},250),P=setInterval(()=>{let e=Math.random()<.1;j.value.face=!0,E.value.face=e?_.xd:_.happy,F=setTimeout(()=>{E.value.face=_.normal,j.value.face=!1},e?M(2*1e3,6*1e3):150)},M(4*1e3,12*1e3)),window.addEventListener(`beforeunload`,I,{passive:!0})}return p(I),f(()=>A.value,()=>{A.value?(E.value.body=m.sit,k.value=O.get()):E.value.body=m.stand}),v(()=>{if(A.value)return;let e=O.get();if(e===k.value||k.value>window.innerWidth-100){j.value.walk||(j.value.walk=!0,setTimeout(()=>{k.value=M(100,window.innerWidth-100),j.value.walk=!1},M(4*1e3,24*1e3)));return}let t=k.value>e?1:-1,n=e+t*S;t&&(E.value.side=t>0?`right`:`left`);let r=t>0?Math.min(n,k.value):Math.max(n,k.value);O.set(r)}),(r,l)=>(a(),s(`div`,{class:`absolute left-0 w-full h-0`,ref_key:`constraint`,ref:i,style:{width:`calc(100% - 96px)`}},[e(t(g).div,{id:`elysia-chan`,drag:`x`,"drag-constraints":i.value,"aria-label":`Elysia chan chibi`,class:`fixed z-30 bottom-0 h-32 sm:h-40 select-none`,style:n([{"aspect-ratio":`1251/2036`},{x:t(O),display:t(T).body&&t(T).face?`block`:`none`}]),onClick:l[2]||=e=>c(A)?A.value=!t(A):A=!t(A)},{default:d(()=>[o(`div`,x,[o(`div`,{className:`relative w-full h-full`,style:n({transform:E.value.side===`left`?`scaleX(-1)`:`scaleX(1)`})},[o(`img`,{src:y,alt:`Elysia Chan`,class:`absolute z-20 w-[66%] left-[17%] object-cover pointer-events-none`,style:n([{"aspect-ratio":`847/565`,"object-position":`0%`},{top:D.value+`%`,"object-position":E.value.face*50+`%`}]),onLoad:l[0]||=e=>t(T).body=!0},null,36),o(`img`,{src:b,alt:`Elysia Chan`,class:`absolute z-10 w-full h-full object-cover pointer-events-none`,style:n([{"aspect-ratio":`1251/2036`,"object-position":`0%`},{"object-position":E.value.body*50+`%`}]),onLoad:l[1]||=e=>t(T).face=!0},null,36)],4)])]),_:1},8,[`drag-constraints`,`style`])],512))}});export{C as default};