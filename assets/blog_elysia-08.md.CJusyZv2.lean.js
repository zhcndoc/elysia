import{C as e,S as t,V as n,_ as r,b as i,it as a}from"./chunks/vue.runtime.esm-bundler.BB7fvrom.js";import"./chunks/banner.DpkE44SY.js";import"./chunks/ray.DH5EacAR.js";import{t as o}from"./chunks/Layout.BZ0rZhD9.js";const s=JSON.parse(`{"title":"Elysia 0.8 - 施坦纳之门","description":"介绍宏 API，一种新的与 Elysia 交互的方式。新的生命周期、解析和映射响应，以更好地与 Elysia 互动。静态内容提前编译静态资源。默认属性、默认头，以及若干改进。","frontmatter":{"title":"Elysia 0.8 - 施坦纳之门","sidebar":false,"editLink":false,"search":false,"comment":false,"head":[["meta",{"property":"og:title","content":"介绍 Elysia 0.8 - 施坦纳之门"}],["meta",{"name":"description","content":"介绍宏 API，一种新的与 Elysia 交互的方式。新的生命周期、解析和映射响应，以更好地与 Elysia 互动。静态内容提前编译静态资源。默认属性、默认头，以及若干改进。"}],["meta",{"property":"og:description","content":"介绍宏 API，一种新的与 Elysia 交互的方式。新的生命周期、解析和映射响应，以更好地与 Elysia 互动。静态内容提前编译静态资源。默认属性、默认头，以及若干改进。"}],["meta",{"property":"og:image","content":"https://elysiajs.com/blog/elysia-08/gate-of-steiner.webp"}],["meta",{"property":"twitter:image","content":"https://elysiajs.com/blog/elysia-08/gate-of-steiner.webp"}]]},"headers":[],"relativePath":"blog/elysia-08.md","filePath":"blog/elysia-08.md","lastUpdated":1768116877000}`);var c=Object.assign({name:`blog/elysia-08.md`},{setup(s){return(s,c)=>(n(),i(`div`,null,[e(o,{title:`Elysia 0.8 - 施坦纳之门`,src:`/blog/elysia-08/gate-of-steiner.webp`,alt:`太空中漂浮的卫星，面向辽阔的世界`,author:`saltyaom`,date:`2023 年 12 月 23 日`},{default:a(()=>[...c[0]||=[r(`p`,null,[t(`以《Steins;Gate Zero》的结尾曲`),r(`a`,{href:`https://youtu.be/S5fnglcM5VI`,target:`_blank`,rel:`noreferrer`},[r(`strong`,null,`"施坦纳之门"`)]),t(`命名。`)],-1),r(`p`,null,`施坦纳之门并不专注于新的激动人心的 API 和功能，而是关注 API 的稳定性和坚实的基础，以确保在 Elysia 1.0 发布后，API 将会稳定。`,-1),r(`p`,null,`然而，我们仍然带来了改进和新特性，包括：`,-1),r(`ul`,null,[r(`li`,null,[r(`a`,{href:`#宏-api`},`宏 API`)]),r(`li`,null,[r(`a`,{href:`#新的生命周期`},`新的生命周期：解析，映射响应`)]),r(`li`,null,[r(`a`,{href:`#错误函数`},`错误函数`)]),r(`li`,null,[r(`a`,{href:`#静态内容`},`静态内容`)]),r(`li`,null,[r(`a`,{href:`#默认属性`},`默认属性`)]),r(`li`,null,[r(`a`,{href:`#默认头`},`默认头`)]),r(`li`,null,[r(`a`,{href:`#性能和显著改进`},`性能和显著改进`)])],-1),r(`h2`,{id:`宏-api`,tabindex:`-1`},[t(`宏 API `),r(`a`,{class:`header-anchor`,href:`#宏-api`,"aria-label":`Permalink to “宏 API”`},`​`)],-1),r(`p`,null,`宏允许我们定义一个自定义字段，通过暴露完整的生命周期事件栈进行钩住和保护。`,-1),r(`p`,null,`这使我们能够将自定义逻辑编排成一个简单的配置，且具有完整的类型安全。`,-1),r(`p`,null,[t(`假设我们有一个身份验证插件，根据角色限制访问，我们可以定义一个自定义的 `),r(`strong`,null,`角色`),t(` 字段。`)],-1),r(`div`,{class:`language-typescript`},[r(`button`,{title:`Copy Code`,class:`copy`}),r(`span`,{class:`lang`},`typescript`),r(`pre`,{class:`shiki shiki-themes github-light github-dark`,style:{"--shiki-light":`#24292e`,"--shiki-dark":`#e1e4e8`,"--shiki-light-bg":`#fff`,"--shiki-dark-bg":`#24292e`},tabindex:`0`,dir:`ltr`},[r(`code`,null,[r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`import`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` { Elysia } `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`from`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},` 'elysia'`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`import`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` { auth } `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`from`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},` '@services/auth'`)]),t(`
`),r(`span`,{class:`line`}),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`const`),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},` app`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},` =`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},` new`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` Elysia`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`()`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`use`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(auth)`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`get`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'/'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`, ({ `),r(`span`,{style:{"--shiki-light":`#E36209`,"--shiki-dark":`#FFAB70`}},`user`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` }) `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=>`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` user.profile, {`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`        role: `),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'admin'`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    })`)])])])],-1),r(`p`,null,`宏拥有对生命周期栈的完全访问权限，使我们能够直接为每个路由添加、修改或删除现有事件。`,-1),r(`div`,{class:`language-typescript`},[r(`button`,{title:`Copy Code`,class:`copy`}),r(`span`,{class:`lang`},`typescript`),r(`pre`,{class:`shiki shiki-themes github-light github-dark`,style:{"--shiki-light":`#24292e`,"--shiki-dark":`#e1e4e8`,"--shiki-light-bg":`#fff`,"--shiki-dark-bg":`#24292e`},tabindex:`0`,dir:`ltr`},[r(`code`,null,[r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`const`),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},` plugin`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},` =`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},` new`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` Elysia`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`({ name: `),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'plugin'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` }).`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`macro`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(({ `),r(`span`,{style:{"--shiki-light":`#E36209`,"--shiki-dark":`#FFAB70`}},`beforeHandle`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` }) `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=>`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` {`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`    return`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` {`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`        role`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#E36209`,"--shiki-dark":`#FFAB70`}},`type`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`:`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},` 'admin'`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},` |`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},` 'user'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`) {`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`            beforeHandle`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`                { insert: `),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'before'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` },`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`                async`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` ({ `),r(`span`,{style:{"--shiki-light":`#E36209`,"--shiki-dark":`#FFAB70`}},`cookie`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`: { `),r(`span`,{style:{"--shiki-light":`#E36209`,"--shiki-dark":`#FFAB70`}},`session`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` } }) `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=>`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` {`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`                    const`),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},` user`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},` =`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},` await`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` validateSession`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(session.value)`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`                    await`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` validateRole`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'admin'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`, user)`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`                }`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`            )`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`        }`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    }`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`})`)])])])],-1),r(`p`,null,`我们希望通过这个宏 API，插件维护者能够根据自己的需要定制 Elysia，为更好地与 Elysia 互动开启新的方式，而 Elysia 用户将能够享受更符合人机工程学的 API。`,-1),r(`p`,null,[r(`a`,{href:`/patterns/macro.html`},`宏 API`),t(` 文档现在已在 `),r(`strong`,null,`模式`),t(` 部分提供。`)],-1),r(`p`,null,`下一代可定制性现在只需伸手可及，等待你的键盘和想象力。`,-1),r(`h2`,{id:`新生命周期`,tabindex:`-1`},[t(`新生命周期 `),r(`a`,{class:`header-anchor`,href:`#新生命周期`,"aria-label":`Permalink to “新生命周期”`},`​`)],-1),r(`p`,null,[t(`Elysia 引入了一个新的生命周期，以解决现有问题和高度请求的 API，包括 `),r(`strong`,null,`解析`),t(` 和 `),r(`strong`,null,`映射响应`),t(`： resolve: 一个安全版本的 `),r(`strong`,null,`derive`),t(`。在与 `),r(`strong`,null,`beforeHandle`),t(` 相同的队列中执行。 mapResponse: 在 `),r(`strong`,null,`afterResponse`),t(` 之后执行，用于提供从原始值到 Web 标准响应的转换函数。`)],-1),r(`h3`,{id:`解析`,tabindex:`-1`},[t(`解析 `),r(`a`,{class:`header-anchor`,href:`#解析`,"aria-label":`Permalink to “解析”`},`​`)],-1),r(`p`,null,[t(`一个 `),r(`a`,{href:`/essential/context.html#derive`},`derive`),t(` 的“安全”版本。`)],-1),r(`p`,null,[t(`旨在在验证过程后将新值追加到上下文中，并存储在与 `),r(`strong`,null,`beforeHandle`),t(` 相同的栈中。`)],-1),r(`p`,null,[t(`解析语法与 `),r(`a`,{href:`/life-cycle/before-handle.html#derive`},`derive`),t(` 完全相同，以下是从授权插件中检索 bearer 头的示例。`)],-1),r(`div`,{class:`language-typescript`},[r(`button`,{title:`Copy Code`,class:`copy`}),r(`span`,{class:`lang`},`typescript`),r(`pre`,{class:`shiki shiki-themes github-light github-dark`,style:{"--shiki-light":`#24292e`,"--shiki-dark":`#e1e4e8`,"--shiki-light-bg":`#fff`,"--shiki-dark-bg":`#24292e`},tabindex:`0`,dir:`ltr`},[r(`code`,null,[r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`import`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` { Elysia } `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`from`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},` 'elysia'`)]),t(`
`),r(`span`,{class:`line`}),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`new`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` Elysia`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`()`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`guard`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`        {`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`            headers: t.`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`Object`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`({`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`                authorization: t.`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`TemplateLiteral`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},"'Bearer ${string}'"),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`)`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`            })`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`        },`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`        (`),r(`span`,{style:{"--shiki-light":`#E36209`,"--shiki-dark":`#FFAB70`}},`app`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`) `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=>`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`            app`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`                .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`resolve`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(({ `),r(`span`,{style:{"--shiki-light":`#E36209`,"--shiki-dark":`#FFAB70`}},`headers`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`: { `),r(`span`,{style:{"--shiki-light":`#E36209`,"--shiki-dark":`#FFAB70`}},`authorization`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` } }) `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=>`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` {`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`                    return`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` {`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`                        bearer: authorization.`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`split`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`' '`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`)[`),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`1`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`]`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`                    }`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`                })`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`                .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`get`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'/'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`, ({ `),r(`span`,{style:{"--shiki-light":`#E36209`,"--shiki-dark":`#FFAB70`}},`bearer`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` }) `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=>`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` bearer)`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    )`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`listen`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`3000`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`)`)])])])],-1),r(`h3`,{id:`映射响应`,tabindex:`-1`},[t(`映射响应 `),r(`a`,{class:`header-anchor`,href:`#映射响应`,"aria-label":`Permalink to “映射响应”`},`​`)],-1),r(`p`,null,[t(`在 `),r(`strong`,null,`"afterHandle"`),t(` 之后立即执行，旨在提供从原始值到 Web 标准响应的自定义响应映射。`)],-1),r(`p`,null,`以下是使用映射响应提供响应压缩的示例。`,-1),r(`div`,{class:`language-typescript`},[r(`button`,{title:`Copy Code`,class:`copy`}),r(`span`,{class:`lang`},`typescript`),r(`pre`,{class:`shiki shiki-themes github-light github-dark`,style:{"--shiki-light":`#24292e`,"--shiki-dark":`#e1e4e8`,"--shiki-light-bg":`#fff`,"--shiki-dark-bg":`#24292e`},tabindex:`0`,dir:`ltr`},[r(`code`,null,[r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`import`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` { Elysia, mapResponse } `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`from`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},` 'elysia'`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`import`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` { gzipSync } `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`from`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},` 'bun'`)]),t(`
`),r(`span`,{class:`line`}),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`new`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` Elysia`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`()`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`mapResponse`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(({ `),r(`span`,{style:{"--shiki-light":`#E36209`,"--shiki-dark":`#FFAB70`}},`response`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` }) `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=>`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` {`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`        return`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},` new`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` Response`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`            gzipSync`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`                typeof`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` response `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`===`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},` 'object'`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`                    ?`),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},` JSON`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`.`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`stringify`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(response)`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`                    :`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` response.`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`toString`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`()`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`            )`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`        )`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    })`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`listen`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`3000`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`)`)])])])],-1),r(`p`,null,[t(`为什么不使用 `),r(`strong`,null,`afterHandle`),t(` 而是引入一个新的 API？`)],-1),r(`p`,null,[t(`因为 `),r(`strong`,null,`afterHandle`),t(` 旨在读取和修改原始值。存储插件如 HTML 和压缩依赖于创建 Web 标准响应。`)],-1),r(`p`,null,`这意味着在这种类型的插件之后注册的插件将无法读取或修改值，从而导致插件行为不正确。`,-1),r(`p`,null,[t(`这就是为什么我们引入了一个新的生命周期，在 `),r(`strong`,null,`afterHandle`),t(` 之后运行，专门用于提供自定义响应映射，而不是将响应映射和原始值变更混合在同一个队列中。`)],-1),r(`h2`,{id:`错误函数`,tabindex:`-1`},[t(`错误函数 `),r(`a`,{class:`header-anchor`,href:`#错误函数`,"aria-label":`Permalink to “错误函数”`},`​`)],-1),r(`p`,null,[t(`我们可以通过使用 `),r(`strong`,null,`set.status`),t(` 或返回一个新的响应来设置状态代码。`)],-1),r(`div`,{class:`language-typescript`},[r(`button`,{title:`Copy Code`,class:`copy`}),r(`span`,{class:`lang`},`typescript`),r(`pre`,{class:`shiki shiki-themes github-light github-dark`,style:{"--shiki-light":`#24292e`,"--shiki-dark":`#e1e4e8`,"--shiki-light-bg":`#fff`,"--shiki-dark-bg":`#24292e`},tabindex:`0`,dir:`ltr`},[r(`code`,null,[r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`import`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` { Elysia } `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`from`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},` 'elysia'`)]),t(`
`),r(`span`,{class:`line`}),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`new`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` Elysia`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`()`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`get`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'/'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`, ({ `),r(`span`,{style:{"--shiki-light":`#E36209`,"--shiki-dark":`#FFAB70`}},`set`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` }) `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=>`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` {`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`        set.status `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=`),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},` 418`)]),t(`
`),r(`span`,{class:`line`}),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`        return`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},` "我是一个水壶"`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    })`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`listen`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`3000`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`)`)])])])],-1),r(`p`,null,`这与我们的目标是一致的，即直接将字面值返回给客户端，而无须担心服务器应如何行为。`,-1),r(`p`,null,`然而，这在与 Eden 集成时证明有挑战性。由于我们返回一个字面值，我们无法从响应中推断出状态代码，从而使得 Eden 无法区分响应和状态代码。`,-1),r(`p`,null,`这导致 Eden 无法充分发挥其潜力，特别是在错误处理时，因为它无法推断类型，而不必为每个状态声明显式响应类型。`,-1),r(`p`,null,[t(`伴随着许多用户请求我们希望提供一种更明确的方式来直接返回状态代码的值，而不希望依赖于 `),r(`strong`,null,`set.status`),t(` 和 `),r(`strong`,null,`new Response`),t(` 来进行冗长或从处理函数外部声明的实用函数返回响应。`)],-1),r(`p`,null,[t(`这就是我们引入 `),r(`strong`,null,`error`),t(` 函数以状态代码和值一起返回给客户端的原因。`)],-1),r(`div`,{class:`language-typescript`},[r(`button`,{title:`Copy Code`,class:`copy`}),r(`span`,{class:`lang`},`typescript`),r(`pre`,{class:`shiki shiki-themes github-light github-dark has-diff`,style:{"--shiki-light":`#24292e`,"--shiki-dark":`#e1e4e8`,"--shiki-light-bg":`#fff`,"--shiki-dark-bg":`#24292e`},tabindex:`0`,dir:`ltr`},[r(`code`,null,[r(`span`,{class:`line diff add`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`import`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` { Elysia, error } `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`from`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},` 'elysia'`)]),t(`
`),r(`span`,{class:`line`}),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`new`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` Elysia`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`()`)]),t(`
`),r(`span`,{class:`line diff add`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`get`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'/'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`, () `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=>`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` error`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`418`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`, `),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`"我是一个水壶"`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`)) `)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`listen`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`3000`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`)`)])])])],-1),r(`p`,null,`这相当于：`,-1),r(`div`,{class:`language-typescript`},[r(`button`,{title:`Copy Code`,class:`copy`}),r(`span`,{class:`lang`},`typescript`),r(`pre`,{class:`shiki shiki-themes github-light github-dark`,style:{"--shiki-light":`#24292e`,"--shiki-dark":`#e1e4e8`,"--shiki-light-bg":`#fff`,"--shiki-dark-bg":`#24292e`},tabindex:`0`,dir:`ltr`},[r(`code`,null,[r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`import`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` { Elysia } `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`from`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},` 'elysia'`)]),t(`
`),r(`span`,{class:`line`}),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`new`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` Elysia`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`()`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`get`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'/'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`, ({ `),r(`span`,{style:{"--shiki-light":`#E36209`,"--shiki-dark":`#FFAB70`}},`set`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` }) `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=>`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` {`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`        set.status `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=`),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},` 418`)]),t(`
`),r(`span`,{class:`line`}),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`        return`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},` "我是一个水壶"`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    })`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`listen`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`3000`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`)`)])])])],-1),r(`p`,null,[t(`不同之处在于，使用 `),r(`strong`,null,`error`),t(` 函数时，Elysia 将自动将状态代码区分为专用响应类型，帮助 Eden 根据状态正确推断响应。`)],-1),r(`p`,null,[t(`这意味着通过使用 `),r(`strong`,null,`error`),t(`，我们不必包含显式响应模式，以便让 Eden 正确推断每个状态代码的类型。`)],-1),r(`div`,{class:`language-typescript`},[r(`button`,{title:`Copy Code`,class:`copy`}),r(`span`,{class:`lang`},`typescript`),r(`pre`,{class:`shiki shiki-themes github-light github-dark has-diff`,style:{"--shiki-light":`#24292e`,"--shiki-dark":`#e1e4e8`,"--shiki-light-bg":`#fff`,"--shiki-dark-bg":`#24292e`},tabindex:`0`,dir:`ltr`},[r(`code`,null,[r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`import`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` { Elysia, error, t } `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`from`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},` 'elysia'`)]),t(`
`),r(`span`,{class:`line`}),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`new`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` Elysia`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`()`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`get`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'/'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`, ({ `),r(`span`,{style:{"--shiki-light":`#E36209`,"--shiki-dark":`#FFAB70`}},`set`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` }) `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=>`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` {`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`        set.status `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=`),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},` 418`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`        return`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},` "我是一个水壶"`)]),t(`
`),r(`span`,{class:`line diff remove`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    }, { `)]),t(`
`),r(`span`,{class:`line diff remove`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`        response: { `)]),t(`
`),r(`span`,{class:`line diff remove`},[r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`            418`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`: t.`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`String`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`() `)]),t(`
`),r(`span`,{class:`line diff remove`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`        } `)]),t(`
`),r(`span`,{class:`line diff remove`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    }) `)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`listen`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`3000`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`)`)])])])],-1),r(`p`,null,[t(`我们建议使用 `),r(`code`,null,`error`),t(` 函数来返回具有状态代码的响应，以获得正确的类型推断，不过，我们并不打算删除 Elysia 中使用 `),r(`strong`,null,`set.status`),t(` 的功能，以保持现有服务器的正常工作。`)],-1),r(`h2`,{id:`静态内容`,tabindex:`-1`},[t(`静态内容 `),r(`a`,{class:`header-anchor`,href:`#静态内容`,"aria-label":`Permalink to “静态内容”`},`​`)],-1),r(`p`,null,`静态内容指的是几乎总是返回相同值的响应，无论传入请求是什么。`,-1),r(`p`,null,[t(`这类资源通常是公共 `),r(`strong`,null,`文件`),t(`、`),r(`strong`,null,`视频`),t(` 或者是极少更改的硬编码值，除非服务器更新。`)],-1),r(`p`,null,`到目前为止，Elysia 中的大部分内容都是静态内容。但我们也发现许多情况，如提供静态文件或使用模板引擎提供 HTML 页面，通常也是静态内容。`,-1),r(`p`,null,`这就是 Elysia 引入新 API 的原因，以通过预先确定响应来优化静态内容。`,-1),r(`div`,{class:`language-typescript`},[r(`button`,{title:`Copy Code`,class:`copy`}),r(`span`,{class:`lang`},`typescript`),r(`pre`,{class:`shiki shiki-themes github-light github-dark has-diff`,style:{"--shiki-light":`#24292e`,"--shiki-dark":`#e1e4e8`,"--shiki-light-bg":`#fff`,"--shiki-dark-bg":`#24292e`},tabindex:`0`,dir:`ltr`},[r(`code`,null,[r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`new`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` Elysia`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`()`)]),t(`
`),r(`span`,{class:`line diff remove`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`get`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'/'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`, () `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=>`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` Bun.`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`file`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'video/kyuukurarin.mp4'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`)) `)]),t(`
`),r(`span`,{class:`line diff add`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`get`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'/'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`, Bun.`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`file`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'video/kyuukurarin.mp4'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`)) `)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`listen`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`3000`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`)`)])])])],-1),r(`p`,null,`请注意，处理程序现在不是一个函数，而是一个内联值。`,-1),r(`p`,null,`这将使性能提高约 20-25%，通过提前编译响应来实现。`,-1),r(`h2`,{id:`默认属性`,tabindex:`-1`},[t(`默认属性 `),r(`a`,{class:`header-anchor`,href:`#默认属性`,"aria-label":`Permalink to “默认属性”`},`​`)],-1),r(`p`,null,[t(`Elysia 0.8 更新了 `),r(`a`,{href:`https://github.com/sinclairzx81/typebox/blob/index/changelog/0.32.0.md`,target:`_blank`,rel:`noreferrer`},`TypeBox 到 0.32`),t(`，引入了许多新特性，包括专用正则表达式、解引用，但最重要的是 Elysia 中最被请求的特性，`),r(`strong`,null,`默认`),t(` 字段支持。`)],-1),r(`p`,null,`现在在类型构建器中定义默认字段，如果未提供值，Elysia 将提供默认值，支持从类型到正文的模式类型。`,-1),r(`div`,{class:`language-typescript`},[r(`button`,{title:`Copy Code`,class:`copy`}),r(`span`,{class:`lang`},`typescript`),r(`pre`,{class:`shiki shiki-themes github-light github-dark`,style:{"--shiki-light":`#24292e`,"--shiki-dark":`#e1e4e8`,"--shiki-light-bg":`#fff`,"--shiki-dark-bg":`#24292e`},tabindex:`0`,dir:`ltr`},[r(`code`,null,[r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`import`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` { Elysia } `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`from`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},` 'elysia'`)]),t(`
`),r(`span`,{class:`line`}),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`new`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` Elysia`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`()`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`get`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'/'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`, ({ `),r(`span`,{style:{"--shiki-light":`#E36209`,"--shiki-dark":`#FFAB70`}},`query`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`: { `),r(`span`,{style:{"--shiki-light":`#E36209`,"--shiki-dark":`#FFAB70`}},`name`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` } }) `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=>`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` name, {`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`        query: t.`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`Object`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`({`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`            name: t.`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`String`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`({`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`                default: `),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'Elysia'`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`            })`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`        })`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    })`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`listen`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`3000`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`)`)])])])],-1),r(`p`,null,`这使我们能够直接从模式提供默认值，尤其是在使用引用模式时特别有用。`,-1),r(`h2`,{id:`默认头`,tabindex:`-1`},[t(`默认头 `),r(`a`,{class:`header-anchor`,href:`#默认头`,"aria-label":`Permalink to “默认头”`},`​`)],-1),r(`p`,null,[t(`我们可以使用 `),r(`strong`,null,`set.headers`),t(` 设置头，Elysia 总是为每个请求创建一个默认的空对象。`)],-1),r(`p`,null,[t(`此前，我们可以使用 `),r(`strong`,null,`onRequest`),t(` 来将所需的值附加到 set.headers，但这始终会有一些开销，因为会调用一个函数。`)],-1),r(`p`,null,`堆叠函数以变更对象可能比在每个请求中直接设置所需值（比如 CORS 或缓存头）要慢。`,-1),r(`p`,null,`这就是我们现在支持从一开始设置默认头，而不是为每个新请求创建一个空对象的原因。`,-1),r(`div`,{class:`language-typescript`},[r(`button`,{title:`Copy Code`,class:`copy`}),r(`span`,{class:`lang`},`typescript`),r(`pre`,{class:`shiki shiki-themes github-light github-dark`,style:{"--shiki-light":`#24292e`,"--shiki-dark":`#e1e4e8`,"--shiki-light-bg":`#fff`,"--shiki-dark-bg":`#24292e`},tabindex:`0`,dir:`ltr`},[r(`code`,null,[r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`new`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` Elysia`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`()`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`headers`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`({`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`        'X-Powered-By'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`: `),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'Elysia'`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    })`)])])])],-1),r(`p`,null,`Elysia CORS 插件也更新了，以使用这个新 API 来提高性能。`,-1),r(`h2`,{id:`性能和显著改进`,tabindex:`-1`},[t(`性能和显著改进 `),r(`a`,{class:`header-anchor`,href:`#性能和显著改进`,"aria-label":`Permalink to “性能和显著改进”`},`​`)],-1),r(`p`,null,`像往常一样，我们找到了一种方法来进一步优化 Elysia，以确保您获得最佳的开箱即用性能。`,-1),r(`h3`,{id:`移除-bind`,tabindex:`-1`},[t(`移除 bind `),r(`a`,{class:`header-anchor`,href:`#移除-bind`,"aria-label":`Permalink to “移除 bind”`},`​`)],-1),r(`p`,null,[t(`我们发现 `),r(`strong`,null,`.bind`),t(` 使路径查找速度降低了约 5%。通过从我们的代码库中移除绑定，我们可以稍微加快这个过程。`)],-1),r(`h3`,{id:`静态查询分析`,tabindex:`-1`},[t(`静态查询分析 `),r(`a`,{class:`header-anchor`,href:`#静态查询分析`,"aria-label":`Permalink to “静态查询分析”`},`​`)],-1),r(`p`,null,`Elysia 静态代码分析现在能够推断查询，如果查询名称在代码中被引用。`,-1),r(`p`,null,`这通常会在默认情况下导致 15-20% 的速度提升。`,-1),r(`h3`,{id:`视频流`,tabindex:`-1`},[t(`视频流 `),r(`a`,{class:`header-anchor`,href:`#视频流`,"aria-label":`Permalink to “视频流”`},`​`)],-1),r(`p`,null,[t(`Elysia 现在默认为文件和 Blob 添加 `),r(`strong`,null,`content-range`),t(` 头，以修复需要按块发送的大文件（如视频）的问题。`)],-1),r(`p`,null,[t(`为了解决这个问题，Elysia 现在默认添加 `),r(`strong`,null,`content-range`),t(` 头。`)],-1),r(`p`,null,[t(`Elysia 不会在状态代码被设置为 206、304、412、416 时发送 `),r(`strong`,null,`content-range`),t(`，或者当头信息显式提供 `),r(`strong`,null,`content-range`),t(` 时。`)],-1),r(`p`,null,[t(`建议使用 `),r(`a`,{href:`https://github.com/bogeychan/elysia-etag`,target:`_blank`,rel:`noreferrer`},`ETag 插件`),t(` 来正确处理状态代码，以避免来自缓存的 `),r(`strong`,null,`content-range`),t(` 冲突。`)],-1),r(`p`,null,[t(`这是 `),r(`strong`,null,`content-range`),t(` 头的初步支持，我们已创建关于在未来基于 `),r(`a`,{href:`https://datatracker.ietf.org/doc/html/rfc7233#section-4.2`,target:`_blank`,rel:`noreferrer`},`RFC 7233`),t(` 实施更准确行为的讨论。欢迎在 `),r(`a`,{href:`https://github.com/elysiajs/elysia/discussions/371`,target:`_blank`,rel:`noreferrer`},`讨论 371`),t(` 中加入讨论，提出有关 Elysia 的 `),r(`strong`,null,`content-range`),t(` 和 `),r(`strong`,null,`etag 生成`),t(` 的新行为建议。`)],-1),r(`h3`,{id:`运行时内存改进`,tabindex:`-1`},[t(`运行时内存改进 `),r(`a`,{class:`header-anchor`,href:`#运行时内存改进`,"aria-label":`Permalink to “运行时内存改进”`},`​`)],-1),r(`p`,null,`Elysia 现在重用生命周期事件的返回值，而不是声明一个新的专用值。`,-1),r(`p`,null,`这略微减少了 Elysia 的内存使用，对于高峰并发请求表现更好。`,-1),r(`h3`,{id:`插件`,tabindex:`-1`},[t(`插件 `),r(`a`,{class:`header-anchor`,href:`#插件`,"aria-label":`Permalink to “插件”`},`​`)],-1),r(`p`,null,[t(`大多数官方插件现在利用了更新的 `),r(`strong`,null,`Elysia.headers`),t(`、静态内容、`),r(`strong`,null,`MapResponse`),t(` 和修订过的代码，以遵循静态代码分析，进一步提高整体性能。`)],-1),r(`p`,null,`受到改进的插件包括：静态、HTML 和 CORS。`,-1),r(`h3`,{id:`验证错误`,tabindex:`-1`},[t(`验证错误 `),r(`a`,{class:`header-anchor`,href:`#验证错误`,"aria-label":`Permalink to “验证错误”`},`​`)],-1),r(`p`,null,`Elysia 现在将验证错误作为 JSON 返回，而不是文本。`,-1),r(`p`,null,`显示当前错误及所有错误和预期值，以帮助您更容易地识别错误。`,-1),r(`p`,null,`示例：`,-1),r(`div`,{class:`language-json`},[r(`button`,{title:`Copy Code`,class:`copy`}),r(`span`,{class:`lang`},`json`),r(`pre`,{class:`shiki shiki-themes github-light github-dark`,style:{"--shiki-light":`#24292e`,"--shiki-dark":`#e1e4e8`,"--shiki-light-bg":`#fff`,"--shiki-dark-bg":`#24292e`},tabindex:`0`,dir:`ltr`},[r(`code`,null,[r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`{`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`  "type"`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`: `),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`"query"`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`,`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`  "at"`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`: `),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`"密码"`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`,`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`  "message"`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`: `),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`"必填属性"`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`,`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`  "expected"`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`: {`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`    "email"`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`: `),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`"eden@elysiajs.com"`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`,`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`    "password"`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`: `),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`""`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`  },`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`  "found"`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`: {`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`    "email"`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`: `),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`"eden@elysiajs.com"`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`  },`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`  "errors"`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`: [`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    {`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`      "type"`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`: `),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`45`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`,`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`      "schema"`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`: {`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`        "type"`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`: `),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`"string"`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`      },`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`      "path"`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`: `),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`"/密码"`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`,`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`      "message"`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`: `),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`"必填属性"`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    },`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    {`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`      "type"`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`: `),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`54`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`,`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`      "schema"`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`: {`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`        "type"`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`: `),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`"string"`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`      },`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`      "path"`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`: `),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`"/密码"`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`,`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`      "message"`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`: `),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`"期望字符串"`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    }`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`  ]`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`}`)])])])],-1),r(`p`,null,[r(`strong`,null,`expect`),t(` 和 `),r(`strong`,null,`errors`),t(` 字段在生产环境中默认被移除，以防止攻击者识别模型以进行进一步攻击。`)],-1),r(`h2`,{id:`显著改进`,tabindex:`-1`},[t(`显著改进 `),r(`a`,{class:`header-anchor`,href:`#显著改进`,"aria-label":`Permalink to “显著改进”`},`​`)],-1),r(`p`,null,[r(`strong`,null,`改进`)],-1),r(`ul`,null,[r(`li`,null,`懒惰查询引用`),r(`li`,null,[t(`默认向 `),r(`code`,null,`Blob`),t(` 添加 content-range 头`)]),r(`li`,null,`更新 TypeBox 到 0.32`),r(`li`,null,[t(`重写生命周期响应 `),r(`code`,null,`be`),t(` 和 `),r(`code`,null,`af`)])],-1),r(`p`,null,[r(`strong`,null,`重大变更`)],-1),r(`ul`,null,[r(`li`,null,[r(`code`,null,`afterHandle`),t(` 不再提前返回`)])],-1),r(`p`,null,[r(`strong`,null,`变化`)],-1),r(`ul`,null,[r(`li`,null,`更改验证响应为 JSON`),r(`li`,null,[t(`将 derive 与 `),r(`code`,null,`decorator['request']`),t(` 区分为 `),r(`code`,null,`decorator['derive']`)]),r(`li`,null,[r(`code`,null,`derive`),t(` 现在在 onRequest 中不再显示推断类型`)])],-1),r(`p`,null,[r(`strong`,null,`错误修复`)],-1),r(`ul`,null,[r(`li`,null,[t(`从 `),r(`code`,null,`PreContext`),t(` 中移除 `),r(`code`,null,`headers`),t(`、`),r(`code`,null,`path`)]),r(`li`,null,[t(`从 `),r(`code`,null,`PreContext`),t(` 中移除 `),r(`code`,null,`derive`)]),r(`li`,null,[t(`Elysia 类型不输出自定义 `),r(`code`,null,`error`)])],-1),r(`h2`,{id:`结语`,tabindex:`-1`},[t(`结语 `),r(`a`,{class:`header-anchor`,href:`#结语`,"aria-label":`Permalink to “结语”`},`​`)],-1),r(`p`,null,`自首次发布以来，这一路走来都是一次伟大的旅程。`,-1),r(`p`,null,`Elysia 从一个通用的 REST API 框架发展为一个符合人机工程学的框架，以支持端到端类型安全、OpenAPI 文档生成，我们希望继续在未来引入更多激动人心的特性。`,-1),r(`br`,null,null,-1),t(` 我们很高兴能有您和开发者一起用 Elysia 构建令人惊叹的事物，您对 Elysia 的持续支持鼓励着我们不断前进。 `,-1),r(`p`,null,`看到 Elysia 作为社区不断成长令人兴奋：`,-1),r(`ul`,null,[r(`li`,null,[r(`a`,{href:`https://x.com/saltyAom/status/1737468941696421908?s=20`,target:`_blank`,rel:`noreferrer`},`Scalar 的 Elysia 主题`),t(`，为新的文档替代 Swagger UI。`)]),r(`li`,null,[r(`a`,{href:`https://pkgx.dev/`,target:`_blank`,rel:`noreferrer`},`pkgx`),t(` 无缝支持 Elysia。`)]),r(`li`,null,[t(`社区将 Elysia 提交到 `),r(`a`,{href:`https://www.techempower.com/benchmarks/#section=data-r22&hw=ph&test=composite`,target:`_blank`,rel:`noreferrer`},`TechEmpower`),t(` 排名，综合得分第 32，甚至超越了 Go 的 Gin 和 Echo。`)])],-1),r(`p`,null,[t(`我们现在将尽力为每个运行环境、插件和集成提供更多支持，以回报您给予我们的善意，首先是重写文档以更详细和更适合初学者，`),r(`a`,{href:`/integrations/nextj.html`},`与 Nextjs 集成`),t(`、`),r(`a`,{href:`/integrations/astro.html`},`Astro`),t(` 等等将来会有更多。`)],-1),r(`p`,null,`自 0.7 发布以来，我们看到的问题比以往更少。`,-1),r(`p`,null,[t(`现在 `),r(`strong`,null,`我们正在准备 Elysia 的首次稳定版本`),t(`，Elysia 1.0 计划于 `),r(`strong`,null,`2024 年第一季度`),t(` 发布，以回报您的善良。 Elysia 将进入软 API 锁定模式，以防止 API 更改并确保在稳定版本发布后不会或很少有重大修改。`)],-1),r(`p`,null,`所以，您可以期待您的 Elysia 应用从 0.7 开始正常工作，而无需或以最少的变动来支持 Elysia 的稳定版本。`,-1),r(`p`,null,`我们再次感谢您对 Elysia 的持续支持，希望在稳定版本发布日再次见到您。`,-1),r(`p`,null,[r(`em`,null,`为这个世界上所有美好事物而奋斗`),t(`。`)],-1),r(`p`,null,[t(`在那之前，`),r(`em`,null,`El Psy Congroo`),t(`。`)],-1),r(`blockquote`,null,[r(`p`,null,`在黑暗中的一滴 小さな命`),r(`p`,null,`独特而珍贵，永远`),r(`p`,null,`让人感伤的回忆 夢幻の刹那`),r(`p`,null,`让这一刻持续，持续永远`),r(`p`,null,`我们在天际漂流 果てない想い`),r(`p`,null,`充满来自上方的爱`),r(`p`,null,`他引导我的旅程 せまる刻限`),r(`p`,null,`轻轻落泪，跳向新世界`)],-1)]]),_:1})]))}});export{s as __pageData,c as default};