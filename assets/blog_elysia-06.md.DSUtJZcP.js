import{C as e,S as t,V as n,_ as r,b as i,it as a}from"./chunks/vue.runtime.esm-bundler.BB7fvrom.js";import"./chunks/banner.DpkE44SY.js";import"./chunks/ray.DH5EacAR.js";import{t as o}from"./chunks/Layout.BZ0rZhD9.js";const s=JSON.parse(`{"title":"Elysia 0.6 - 这个游戏","description":"介绍重新设计的插件模型、动态模式、更好的开发者体验（通过声明式自定义错误）、可自定义的宽松和严格路径映射、TypeBox 0.30 和 WinterCG 框架的互操作性。再一次推动可能性的边界。","frontmatter":{"title":"Elysia 0.6 - 这个游戏","sidebar":false,"editLink":false,"search":false,"comment":false,"head":[["meta",{"property":"og:title","content":"介绍 Elysia 0.6 - 这个游戏"}],["meta",{"name":"description","content":"介绍重新设计的插件模型、动态模式、更好的开发者体验（通过声明式自定义错误）、可自定义的宽松和严格路径映射、TypeBox 0.30 和 WinterCG 框架的互操作性。再一次推动可能性的边界。"}],["meta",{"property":"og:description","content":"介绍重新设计的插件模型、动态模式、更好的开发者体验（通过声明式自定义错误）、可自定义的宽松和严格路径映射、TypeBox 0.30 和 WinterCG 框架的互操作性。再一次推动可能性的边界。"}],["meta",{"property":"og:image","content":"https://elysiajs.com/blog/elysia-06/this-game.webp"}],["meta",{"property":"twitter:image","content":"https://elysiajs.com/blog/elysia-06/this-game.webp"}]]},"headers":[],"relativePath":"blog/elysia-06.md","filePath":"blog/elysia-06.md","lastUpdated":1768116877000}`);var c=Object.assign({name:`blog/elysia-06.md`},{setup(s){return(s,c)=>(n(),i(`div`,null,[e(o,{title:`Elysia 0.6 - 这个游戏`,src:`/blog/elysia-06/this-game.webp`,alt:`水晶骑士碎片`,author:`saltyaom`,date:`2023 年 8 月 6 日`},{default:a(()=>[...c[0]||=[r(`p`,null,[t(`以传奇动漫 `),r(`strong`,null,`“No Game No Life”`),t(` 的开场曲命名，`),r(`strong`,null,[t(`「`),r(`a`,{href:`https://youtu.be/kJ04dMmimn8`,target:`_blank`,rel:`noreferrer`},`This Game`),t(`」`)]),t(` 作曲者是 Konomi Suzuki。`)],-1),r(`p`,null,`这个游戏将中型项目的边界推向了大型应用程序，重新设计的插件模型、动态模式、声明式自定义错误的开发者体验提升、通过“onResponse”收集更多指标、可自定义的宽松和严格路径映射、TypeBox 0.30 和 WinterCG 框架的互操作性。`,-1),r(`h6`,{id:`我们仍在等待《no-game-no-life》第二季`,tabindex:`-1`},[t(`（我们仍在等待《No Game No Life》第二季） `),r(`a`,{class:`header-anchor`,href:`#我们仍在等待《no-game-no-life》第二季`,"aria-label":`Permalink to “（我们仍在等待《No Game No Life》第二季）”`},`​`)],-1),r(`h2`,{id:`新插件模型`,tabindex:`-1`},[t(`新插件模型 `),r(`a`,{class:`header-anchor`,href:`#新插件模型`,"aria-label":`Permalink to “新插件模型”`},`​`)],-1),r(`p`,null,`这个游戏引入了新的插件注册语法，并提出了新的内部插件模型。`,-1),r(`p`,null,`之前，你可以通过定义 Elysia 实例的回调函数来注册插件，如下所示：`,-1),r(`div`,{class:`language-ts`},[r(`button`,{title:`Copy Code`,class:`copy`}),r(`span`,{class:`lang`},`ts`),r(`pre`,{class:`shiki shiki-themes github-light github-dark`,style:{"--shiki-light":`#24292e`,"--shiki-dark":`#e1e4e8`,"--shiki-light-bg":`#fff`,"--shiki-dark-bg":`#24292e`},tabindex:`0`,dir:`ltr`},[r(`code`,null,[r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`const`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` plugin`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},` =`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` (`),r(`span`,{style:{"--shiki-light":`#E36209`,"--shiki-dark":`#FFAB70`}},`app`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`:`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` Elysia`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`) `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=>`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` app.`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`get`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'/'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`, () `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=>`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},` 'hello'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`)`)])])])],-1),r(`p`,null,`使用新插件模型，你可以将 Elysia 实例直接转化为插件：`,-1),r(`div`,{class:`language-ts`},[r(`button`,{title:`Copy Code`,class:`copy`}),r(`span`,{class:`lang`},`ts`),r(`pre`,{class:`shiki shiki-themes github-light github-dark`,style:{"--shiki-light":`#24292e`,"--shiki-dark":`#e1e4e8`,"--shiki-light-bg":`#fff`,"--shiki-dark-bg":`#24292e`},tabindex:`0`,dir:`ltr`},[r(`code`,null,[r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`const`),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},` plugin`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},` =`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},` new`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` Elysia`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`()`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`get`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'/'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`, () `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=>`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},` 'hello'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`)`)])])])],-1),r(`p`,null,`这允许任何 Elysia 实例甚至现有实例在应用程序中使用，消除了任何可能的额外回调和制表符间隔。`,-1),r(`p`,null,`这显著提升了嵌套组的开发者体验：`,-1),r(`div`,{class:`language-ts`},[r(`button`,{title:`Copy Code`,class:`copy`}),r(`span`,{class:`lang`},`ts`),r(`pre`,{class:`shiki shiki-themes github-light github-dark`,style:{"--shiki-light":`#24292e`,"--shiki-dark":`#e1e4e8`,"--shiki-light-bg":`#fff`,"--shiki-dark-bg":`#24292e`},tabindex:`0`,dir:`ltr`},[r(`code`,null,[r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#6A737D`,"--shiki-dark":`#6A737D`}},`// < 0.6`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`const`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` group`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},` =`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` (`),r(`span`,{style:{"--shiki-light":`#E36209`,"--shiki-dark":`#FFAB70`}},`app`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`:`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` Elysia`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`) `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=>`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` app`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`group`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'/v1'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`, (`),r(`span`,{style:{"--shiki-light":`#E36209`,"--shiki-dark":`#FFAB70`}},`app`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`) `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=>`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` app`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`        .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`get`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'/hello'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`, () `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=>`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},` 'Hello World'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`)`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    )`)]),t(`
`),r(`span`,{class:`line`}),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#6A737D`,"--shiki-dark":`#6A737D`}},`// >= 0.6`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`const`),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},` group`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},` =`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},` new`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` Elysia`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`({ prefix: `),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'/v1'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` })`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`get`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'/hello'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`, () `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=>`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},` 'Hello World'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`)`)])])])],-1),r(`p`,null,`我们鼓励您使用新的 Elysia 插件实例模型，因为我们可以利用插件校验和未来的新特性。`,-1),r(`p`,null,[t(`然而，我们并未`),r(`strong`,null,`弃用`),t(`回调函数方法，因为某些情况下函数模型仍然有用，例如：`)],-1),r(`ul`,null,[r(`li`,null,`内联函数`),r(`li`,null,`需要访问主实例信息的插件（例如访问 OpenAPI 架构）`)],-1),r(`p`,null,`通过这个新的插件模型，我们希望您能够使代码库更易于维护。`,-1),r(`h2`,{id:`插件校验和`,tabindex:`-1`},[t(`插件校验和 `),r(`a`,{class:`header-anchor`,href:`#插件校验和`,"aria-label":`Permalink to “插件校验和”`},`​`)],-1),r(`p`,null,`默认情况下，Elysia 插件使用函数回调来注册插件。`,-1),r(`p`,null,`这意味着如果你为类型声明注册一个插件，它会为了提供类型支持而自我重复，从而在生产中导致插件的重复使用。`,-1),r(`p`,null,`因此引入了插件校验和，以防止类型声明注册的插件重复。`,-1),r(`p`,null,[t(`要使用插件校验和，您需要使用新的插件模型，并提供一个 `),r(`code`,null,`name`),t(` 属性来告诉 Elysia 防止插件重复：`)],-1),r(`div`,{class:`language-ts`},[r(`button`,{title:`Copy Code`,class:`copy`}),r(`span`,{class:`lang`},`ts`),r(`pre`,{class:`shiki shiki-themes github-light github-dark`,style:{"--shiki-light":`#24292e`,"--shiki-dark":`#e1e4e8`,"--shiki-light-bg":`#fff`,"--shiki-dark-bg":`#24292e`},tabindex:`0`,dir:`ltr`},[r(`code`,null,[r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`const`),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},` plugin`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},` =`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},` new`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` Elysia`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`({`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    name: `),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'plugin'`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`})`)])])])],-1),r(`p`,null,`这让 Elysia 能够根据名称识别插件并进行重复消除。`,-1),r(`p`,null,`任何重复的名称将只注册一次，但即使插件已被去重，类型安全将在注册后提供。`,-1),r(`p`,null,[t(`如果您的插件需要配置，可以将配置提供到 `),r(`strong`,null,`seed`),t(` 属性中，以生成去重复插件的校验和。`)],-1),r(`div`,{class:`language-ts`},[r(`button`,{title:`Copy Code`,class:`copy`}),r(`span`,{class:`lang`},`ts`),r(`pre`,{class:`shiki shiki-themes github-light github-dark`,style:{"--shiki-light":`#24292e`,"--shiki-dark":`#e1e4e8`,"--shiki-light-bg":`#fff`,"--shiki-dark-bg":`#24292e`},tabindex:`0`,dir:`ltr`},[r(`code`,null,[r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`const`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` plugin`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},` =`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` (`),r(`span`,{style:{"--shiki-light":`#E36209`,"--shiki-dark":`#FFAB70`}},`config`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`) `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=>`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},` new`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` Elysia`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`({`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    name: `),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'plugin'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`,`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    seed: config`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`})`)])])])],-1),r(`p`,null,`名称和种子将用于生成去重注册的校验和，从而实现更好的性能提升。`,-1),r(`p`,null,`此更新还修复了插件的生命周期重复消除的情况，当 Elysia 不确定插件是本地还是全局事件时，会意外内联生命周期。`,-1),r(`p`,null,`一如既往，这意味着对于大于“Hello World”的应用程序来说性能得到了提升。`,-1),r(`h2`,{id:`挂载和-wintercg-合规`,tabindex:`-1`},[t(`挂载和 WinterCG 合规 `),r(`a`,{class:`header-anchor`,href:`#挂载和-wintercg-合规`,"aria-label":`Permalink to “挂载和 WinterCG 合规”`},`​`)],-1),r(`p`,null,`WinterCG 是一个由 Cloudflare、Deno、Vercel Edge Runtime、Netlify Functions 和其他多种支持的网络互操作运行时标准。`,-1),r(`p`,null,`WinterCG 允许 Web 服务器在运行时之间进行互操作，它使用 Fetch、Request 和 Response 等 Web 标准定义。`,-1),r(`p`,null,`基于此，Elysia 部分遵循 WinterCG 合规，因为我们对 Bun 进行了优化，但在可能的情况下也开放地支持其他运行时。`,-1),r(`p`,null,[t(`这理论上允许任何框架和代码在一起运行，只要它们符合 WinterCG 的标准，这一实现由 `),r(`a`,{href:`https://honojs.dev`,target:`_blank`,rel:`noreferrer`},`Hono`),t(` 提出，它引入了 `),r(`strong`,null,`.mount`),t(` 方法，以 `),r(`a`,{href:`https://twitter.com/honojs/status/1684839623355490304`,target:`_blank`,rel:`noreferrer`},`在一个代码库中运行多个框架`),t(`，包括 Remix、Elysia、Itty Router 和 Hono 本身。`)],-1),r(`p`,null,[t(`因此，我们通过引入 `),r(`code`,null,`.mount`),t(` 方法实现了相同的逻辑，以运行任何符合 WinterCG 标准的框架或代码。`)],-1),r(`p`,null,[t(`要使用 `),r(`code`,null,`.mount`),t(`，只需 `),r(`a`,{href:`https://twitter.com/saltyAom/status/1684786233594290176`,target:`_blank`,rel:`noreferrer`},[t(`传递一个 `),r(`code`,null,`fetch`),t(` 函数`)]),t(`：`)],-1),r(`div`,{class:`language-ts`},[r(`button`,{title:`Copy Code`,class:`copy`}),r(`span`,{class:`lang`},`ts`),r(`pre`,{class:`shiki shiki-themes github-light github-dark`,style:{"--shiki-light":`#24292e`,"--shiki-dark":`#e1e4e8`,"--shiki-light-bg":`#fff`,"--shiki-dark-bg":`#24292e`},tabindex:`0`,dir:`ltr`},[r(`code`,null,[r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`const`),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},` app`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},` =`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},` new`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` Elysia`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`()`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`get`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'/'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`, () `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=>`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},` 'Hello from Elysia'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`)`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`mount`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'/hono'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`, hono.fetch)`)])])])],-1),r(`p`,null,[r(`strong`,null,`fetch`),t(` 函数是接受 Web 标准请求并返回 Web 标准响应的函数，其定义为：`)],-1),r(`div`,{class:`language-ts`},[r(`button`,{title:`Copy Code`,class:`copy`}),r(`span`,{class:`lang`},`ts`),r(`pre`,{class:`shiki shiki-themes github-light github-dark`,style:{"--shiki-light":`#24292e`,"--shiki-dark":`#e1e4e8`,"--shiki-light-bg":`#fff`,"--shiki-dark-bg":`#24292e`},tabindex:`0`,dir:`ltr`},[r(`code`,null,[r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#6A737D`,"--shiki-dark":`#6A737D`}},`// Web 标准请求类对象`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#6A737D`,"--shiki-dark":`#6A737D`}},`// Web 标准响应`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`type`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` fetch`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},` =`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` (`),r(`span`,{style:{"--shiki-light":`#E36209`,"--shiki-dark":`#FFAB70`}},`request`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`:`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` RequestLike`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`) `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=>`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` Response`)])])])],-1),r(`p`,null,`默认情况下，此声明适用于：`,-1),r(`ul`,null,[r(`li`,null,`Bun`),r(`li`,null,`Deno`),r(`li`,null,`Vercel Edge Runtime`),r(`li`,null,`Cloudflare Worker`),r(`li`,null,`Netlify Edge Function`),r(`li`,null,`Remix Function Handler`)],-1),r(`p`,null,`这意味着您可以在同一服务器上运行上述所有代码与 Elysia 互操作，所有功能都可以在单次部署中重用，不再需要设置反向代理以处理多个服务器。`,-1),r(`p`,null,[t(`如果框架还支持 `),r(`strong`,null,`.mount`),t(` 函数，您可以无限嵌套支持此功能的框架。`)],-1),r(`div`,{class:`language-ts`},[r(`button`,{title:`Copy Code`,class:`copy`}),r(`span`,{class:`lang`},`ts`),r(`pre`,{class:`shiki shiki-themes github-light github-dark`,style:{"--shiki-light":`#24292e`,"--shiki-dark":`#e1e4e8`,"--shiki-light-bg":`#fff`,"--shiki-dark-bg":`#24292e`},tabindex:`0`,dir:`ltr`},[r(`code`,null,[r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`const`),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},` elysia`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},` =`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},` new`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` Elysia`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`()`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`get`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'/Hello from Elysia inside Hono inside Elysia'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`)`)]),t(`
`),r(`span`,{class:`line`}),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`const`),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},` hono`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},` =`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},` new`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` Hono`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`()`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`get`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'/'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`, (`),r(`span`,{style:{"--shiki-light":`#E36209`,"--shiki-dark":`#FFAB70`}},`c`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`) `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=>`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` c.`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`text`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'Hello from Hono!'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`))`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`mount`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'/elysia'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`, elysia.fetch)`)]),t(`
`),r(`span`,{class:`line`}),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`const`),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},` main`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},` =`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},` new`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` Elysia`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`()`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`get`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'/'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`, () `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=>`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},` 'Hello from Elysia'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`)`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`mount`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'/hono'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`, hono.fetch)`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`listen`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`3000`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`)`)])])])],-1),r(`p`,null,`您甚至可以在服务器中重用多个现有的 Elysia 项目。`,-1),r(`div`,{class:`language-ts`},[r(`button`,{title:`Copy Code`,class:`copy`}),r(`span`,{class:`lang`},`ts`),r(`pre`,{class:`shiki shiki-themes github-light github-dark`,style:{"--shiki-light":`#24292e`,"--shiki-dark":`#e1e4e8`,"--shiki-light-bg":`#fff`,"--shiki-dark-bg":`#24292e`},tabindex:`0`,dir:`ltr`},[r(`code`,null,[r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`import`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` A `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`from`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},` 'project-a/elysia'`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`import`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` B `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`from`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},` 'project-b/elysia'`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`import`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` C `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`from`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},` 'project-c/elysia'`)]),t(`
`),r(`span`,{class:`line`}),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`new`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` Elysia`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`()`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`mount`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`A`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`)`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`mount`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`B`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`)`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`mount`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`C`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`)`)])])])],-1),r(`p`,null,[t(`如果挂载的实例是 Elysia 实例，它将自动解析为 `),r(`code`,null,`use`),t(`，提供默认的类型安全和 Eden 支持。`)],-1),r(`p`,null,`这使得互操作框架和运行时成为现实的可能性。`,-1),r(`h2`,{id:`启动时间改善`,tabindex:`-1`},[t(`启动时间改善 `),r(`a`,{class:`header-anchor`,href:`#启动时间改善`,"aria-label":`Permalink to “启动时间改善”`},`​`)],-1),r(`p`,null,`启动时间是一个在无服务器环境中重要的度量，Elysia 在这方面表现出色，但我们已经进一步提升了这一点。`,-1),r(`p`,null,`默认情况下，Elysia 会自动生成每个路由的 OpenAPI 架构并在内部存储，即使不使用。`,-1),r(`p`,null,[t(`在这个版本中，Elysia 推迟了编译，并移至 `),r(`code`,null,`@elysiajs/swagger`),t(`，从而使 Elysia 的启动时间更快。`)],-1),r(`p`,null,`通过各种微优化，并在新的插件模型的帮助下，启动时间现在提高了多达 35%。`,-1),r(`h2`,{id:`动态模式`,tabindex:`-1`},[t(`动态模式 `),r(`a`,{class:`header-anchor`,href:`#动态模式`,"aria-label":`Permalink to “动态模式”`},`​`)],-1),r(`p`,null,`Elysia 引入了静态代码分析和预编译（Ahead of Time Compilation）以推动性能的边界。`,-1),r(`p`,null,`静态代码分析允许 Elysia 阅读您的代码，然后生成最优化的代码版本，允许 Elysia 将性能推至极限。`,-1),r(`p`,null,`即使 Elysia 符合 WinterCG，像 Cloudflare Worker 这样的环境也不支持函数组合。`,-1),r(`p`,null,`这意味着无法进行预编译，从而促使我们创建了一种动态模式，采用 JIT 编译而不是 AoT，使 Elysia 也能够在 Cloudflare Worker 上运行。`,-1),r(`p`,null,[t(`要启用动态模式，请将 `),r(`code`,null,`aot`),t(` 设置为 false。`)],-1),r(`div`,{class:`language-ts`},[r(`button`,{title:`Copy Code`,class:`copy`}),r(`span`,{class:`lang`},`ts`),r(`pre`,{class:`shiki shiki-themes github-light github-dark`,style:{"--shiki-light":`#24292e`,"--shiki-dark":`#e1e4e8`,"--shiki-light-bg":`#fff`,"--shiki-dark-bg":`#24292e`},tabindex:`0`,dir:`ltr`},[r(`code`,null,[r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`new`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` Elysia`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`({`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    aot: `),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`false`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`})`)])])])],-1),r(`p`,null,`动态模式在 Cloudflare Worker 中默认启用。`,-1),r(`h4`,{id:`值得注意的是-启用动态模式将禁用一些功能-例如动态注入的代码-如-t-numeric-它会自动将字符串解析为数字。`,tabindex:`-1`},[t(`值得注意的是，启用动态模式将禁用一些功能，例如动态注入的代码，如 `),r(`code`,null,`t.Numeric`),t(`，它会自动将字符串解析为数字。 `),r(`a`,{class:`header-anchor`,href:`#值得注意的是-启用动态模式将禁用一些功能-例如动态注入的代码-如-t-numeric-它会自动将字符串解析为数字。`,"aria-label":`Permalink to “值得注意的是，启用动态模式将禁用一些功能，例如动态注入的代码，如 t.Numeric，它会自动将字符串解析为数字。”`},`​`)],-1),r(`p`,null,`预编译可以读取、检测并优化您的代码，以便换取启动时间的损失，但动态模式使用 JIT 编译，允许启动时间提高到 6 倍。`,-1),r(`p`,null,`但需要注意的是，Elysia 的启动时间默认已经足够快。`,-1),r(`p`,null,`Elysia 能够在仅 78 毫秒内注册 10,000 个路由，这意味着平均每个路由为 0.0079 毫秒。`,-1),r(`p`,null,`综上所述，我们为您留下了自我决策的选择。`,-1),r(`h2`,{id:`声明式自定义错误`,tabindex:`-1`},[t(`声明式自定义错误 `),r(`a`,{class:`header-anchor`,href:`#声明式自定义错误`,"aria-label":`Permalink to “声明式自定义错误”`},`​`)],-1),r(`p`,null,`此更新添加了支持添加类型支持以处理自定义错误的能力。`,-1),r(`div`,{class:`language-ts`},[r(`button`,{title:`Copy Code`,class:`copy`}),r(`span`,{class:`lang`},`ts`),r(`pre`,{class:`shiki shiki-themes github-light github-dark`,style:{"--shiki-light":`#24292e`,"--shiki-dark":`#e1e4e8`,"--shiki-light-bg":`#fff`,"--shiki-dark-bg":`#24292e`},tabindex:`0`,dir:`ltr`},[r(`code`,null,[r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`class`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` CustomError`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},` extends`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` Error`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` {`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`    constructor`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`public`),r(`span`,{style:{"--shiki-light":`#E36209`,"--shiki-dark":`#FFAB70`}},` message`),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`:`),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},` string`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`) {`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`        super`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(message)`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    }`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`}`)]),t(`
`),r(`span`,{class:`line`}),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`new`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` Elysia`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`()`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`addError`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`({`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`        MyError: CustomError`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    })`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`onError`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(({ `),r(`span`,{style:{"--shiki-light":`#E36209`,"--shiki-dark":`#FFAB70`}},`code`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`, `),r(`span`,{style:{"--shiki-light":`#E36209`,"--shiki-dark":`#FFAB70`}},`error`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` }) `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=>`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` {`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`        switch`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(code) {`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#6A737D`,"--shiki-dark":`#6A737D`}},`            // 带自动补全`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`            case`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},` 'MyError'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`:`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#6A737D`,"--shiki-dark":`#6A737D`}},`                // 类型缩小`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#6A737D`,"--shiki-dark":`#6A737D`}},`                // 错误被类型化为 CustomError`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`                return`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` error`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`        }`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    })`)])])])],-1),r(`p`,null,`这让我们能够使用类型缩小来处理自定义类型，从而处理自定义错误，并为错误代码提供自动补全，以缩小到正确的类型，从而实现完全的声明式类型安全。`,-1),r(`p`,null,`这实现了我们主要哲学之一，专注于开发者体验，尤其是类型。`,-1),r(`p`,null,`Elysia 的类型系统复杂，但我们尽量让用户无需编写自定义类型或传递自定义泛型，使所有代码看起来就像 JavaScript。`,-1),r(`p`,null,`它就是这样工作，所有代码看起来都像 JavaScript。`,-1),r(`h2`,{id:`typebox-0-30`,tabindex:`-1`},[t(`TypeBox 0.30 `),r(`a`,{class:`header-anchor`,href:`#typebox-0-30`,"aria-label":`Permalink to “TypeBox 0.30”`},`​`)],-1),r(`p`,null,[t(`TypeBox 是驱动 Elysia 严格类型系统的核心库，称为 `),r(`strong`,null,`Elysia.t`),t(`。`)],-1),r(`p`,null,`在此更新中，我们将 TypeBox 从 0.28 更新到 0.30，以使类型系统更为精细，几乎变成严格类型语言。`,-1),r(`p`,null,[t(`这些更新引入了新功能和许多有趣的变化，例如 `),r(`strong`,null,`Iterator`),t(` 类型、减少包的大小、TypeScript 代码生成。`)],-1),r(`p`,null,`并支持诸如：`,-1),r(`ul`,null,[r(`li`,null,[r(`code`,null,`t.Awaited`)]),r(`li`,null,[r(`code`,null,`t.Uppercase`)]),r(`li`,null,[r(`code`,null,`t.Capitlized`)])],-1),r(`h2`,{id:`严格路径`,tabindex:`-1`},[t(`严格路径 `),r(`a`,{class:`header-anchor`,href:`#严格路径`,"aria-label":`Permalink to “严格路径”`},`​`)],-1),r(`p`,null,`我们收到了很多关于处理宽松路径的请求。`,-1),r(`p`,null,[t(`默认情况下，Elysia 严格处理路径，这意味着如果您需要支持带有或不带可选 `),r(`code`,null,`/`),t(` 的路径，它将无法解析，您必须重复两次路径名称。`)],-1),r(`div`,{class:`language-ts`},[r(`button`,{title:`Copy Code`,class:`copy`}),r(`span`,{class:`lang`},`ts`),r(`pre`,{class:`shiki shiki-themes github-light github-dark`,style:{"--shiki-light":`#24292e`,"--shiki-dark":`#e1e4e8`,"--shiki-light-bg":`#fff`,"--shiki-dark-bg":`#24292e`},tabindex:`0`,dir:`ltr`},[r(`code`,null,[r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`new`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` Elysia`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`()`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`group`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'/v1'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`, (`),r(`span`,{style:{"--shiki-light":`#E36209`,"--shiki-dark":`#FFAB70`}},`app`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`) `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=>`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` app`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#6A737D`,"--shiki-dark":`#6A737D`}},`        // 处理 /v1`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`        .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`get`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`''`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`, handle)`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#6A737D`,"--shiki-dark":`#6A737D`}},`        // 处理 /v1/`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`        .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`get`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'/'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`, handle)`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    )`)])])])],-1),r(`p`,null,[t(`因此，许多人请求 `),r(`code`,null,`/v1/`),t(` 也应该解析为 `),r(`code`,null,`/v1`),t(`。`)],-1),r(`p`,null,`在此更新中，我们默认添加了对宽松路径匹配的支持，以自动启用此功能。`,-1),r(`div`,{class:`language-ts`},[r(`button`,{title:`Copy Code`,class:`copy`}),r(`span`,{class:`lang`},`ts`),r(`pre`,{class:`shiki shiki-themes github-light github-dark`,style:{"--shiki-light":`#24292e`,"--shiki-dark":`#e1e4e8`,"--shiki-light-bg":`#fff`,"--shiki-dark-bg":`#24292e`},tabindex:`0`,dir:`ltr`},[r(`code`,null,[r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`new`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` Elysia`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`()`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`group`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'/v1'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`, (`),r(`span`,{style:{"--shiki-light":`#E36209`,"--shiki-dark":`#FFAB70`}},`app`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`) `),r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`=>`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},` app`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#6A737D`,"--shiki-dark":`#6A737D`}},`        // 处理 /v1 和 /v1/`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`        .`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},`get`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`(`),r(`span`,{style:{"--shiki-light":`#032F62`,"--shiki-dark":`#9ECBFF`}},`'/'`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`, handle)`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    )`)])])])],-1),r(`p`,null,[t(`要禁用宽松路径映射，您可以将 `),r(`code`,null,`strictPath`),t(` 设置为 true，以使用先前的行为：`)],-1),r(`div`,{class:`language-ts`},[r(`button`,{title:`Copy Code`,class:`copy`}),r(`span`,{class:`lang`},`ts`),r(`pre`,{class:`shiki shiki-themes github-light github-dark`,style:{"--shiki-light":`#24292e`,"--shiki-dark":`#e1e4e8`,"--shiki-light-bg":`#fff`,"--shiki-dark-bg":`#24292e`},tabindex:`0`,dir:`ltr`},[r(`code`,null,[r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#D73A49`,"--shiki-dark":`#F97583`}},`new`),r(`span`,{style:{"--shiki-light":`#6F42C1`,"--shiki-dark":`#B392F0`}},` Elysia`),r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`({`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`    strictPath: `),r(`span`,{style:{"--shiki-light":`#005CC5`,"--shiki-dark":`#79B8FF`}},`false`)]),t(`
`),r(`span`,{class:`line`},[r(`span`,{style:{"--shiki-light":`#24292E`,"--shiki-dark":`#E1E4E8`}},`})`)])])])],-1),r(`p`,null,`我们希望这将清除关于路径匹配及其预期行为的任何疑问。`,-1),r(`h2`,{id:`onresponse`,tabindex:`-1`},[t(`onResponse `),r(`a`,{class:`header-anchor`,href:`#onresponse`,"aria-label":`Permalink to “onResponse”`},`​`)],-1),r(`p`,null,[t(`此更新介绍了一个新的生命周期钩子，称为 `),r(`code`,null,`onResponse`),t(`。`)],-1),r(`p`,null,[t(`这是由 `),r(`a`,{href:`https://github.com/elysiajs/elysia/issues/67`,target:`_blank`,rel:`noreferrer`},`elysia#67`),t(` 提出的提案。`)],-1),r(`p`,null,[t(`之前，Elysia 的生命周期如下图所示。 `),r(`img`,{src:`/blog/elysia-06/lifecycle-05.webp`,alt:`Elysia 生命周期图`,"data-zoomable":`true`})],-1),r(`p`,null,[t(`对于任何指标、数据收集或日志记录目的，您可以使用 `),r(`code`,null,`onAfterHandle`),t(` 来运行收集指标的功能，但是当处理程序遇到错误时，此生命周期并不会被执行，无论是路由错误还是提供的自定义错误。`)],-1),r(`p`,null,[t(`这就是为什么我们引入了 `),r(`code`,null,`onResponse`),t(` 以处理所有的响应情况。`)],-1),r(`p`,null,[t(`您可以同时使用 `),r(`code`,null,`onRequest`),t(` 和 `),r(`code`,null,`onResponse`),t(` 来测量性能指标或任何所需的日志记录。`)],-1),r(`p`,null,`引用：`,-1),r(`blockquote`,null,[r(`p`,null,`然而，onAfterHandle 函数仅在成功响应时触发。例如，如果找不到路由，或主体无效，或抛出错误，则不会触发。如何监听成功和不成功的请求？这就是我建议 onResponse 的原因。`),r(`p`,null,[t(`根据图示，我建议如下： `),r(`img`,{src:`/blog/elysia-06/lifecycle-06.webp`,alt:`Elysia 生命周期图, 带 onResponse 钩子`,"data-zoomable":`true`})])],-1),r(`hr`,null,null,-1),r(`h3`,{id:`显著改进`,tabindex:`-1`},[t(`显著改进： `),r(`a`,{class:`header-anchor`,href:`#显著改进`,"aria-label":`Permalink to “显著改进：”`},`​`)],-1),r(`ul`,null,[r(`li`,null,`在 Elysia 类型系统中添加错误字段，以添加自定义错误消息`),r(`li`,null,`支持 Cloudflare Worker 的动态模式（和 ENV）`),r(`li`,null,`AfterHandle 现在自动映射值`),r(`li`,null,`使用 bun build 针对 Bun 环境，整体性能提高 5-10%`),r(`li`,null,`在使用插件注册时消除了内联生命周期的重复`),r(`li`,null,[t(`支持设置 `),r(`code`,null,`prefix`)]),r(`li`,null,`递归路径类型`),r(`li`,null,`轻微提高类型检查速度`),r(`li`,null,`递归架构冲突导致无限类型`)],-1),r(`h3`,{id:`更改`,tabindex:`-1`},[t(`更改： `),r(`a`,{class:`header-anchor`,href:`#更改`,"aria-label":`Permalink to “更改：”`},`​`)],-1),r(`ul`,null,[r(`li`,null,[t(`将 `),r(`strong`,null,`registerSchemaPath`),t(` 移至 @elysiajs/swagger`)]),r(`li`,null,`[内部] 向上下文添加 qi (queryIndex)`)],-1),r(`h3`,{id:`破坏性更改`,tabindex:`-1`},[t(`破坏性更改： `),r(`a`,{class:`header-anchor`,href:`#破坏性更改`,"aria-label":`Permalink to “破坏性更改：”`},`​`)],-1),r(`ul`,null,[r(`li`,null,`[内部] 移除 Elysia Symbol`),r(`li`,null,[t(`[内部] 将 `),r(`code`,null,`getSchemaValidator`),t(`, `),r(`code`,null,`getResponseSchemaValidator`),t(` 重构为命名参数`)]),r(`li`,null,[t(`[内部] 将 `),r(`code`,null,`registerSchemaPath`),t(` 移至 `),r(`code`,null,`@elysiajs/swagger`)])],-1),r(`h2`,{id:`后续`,tabindex:`-1`},[t(`后续 `),r(`a`,{class:`header-anchor`,href:`#后续`,"aria-label":`Permalink to “后续”`},`​`)],-1),r(`p`,null,`我们刚刚迈过了一年的里程碑，对于 Elysia 和 Bun 在这一年的改进感到非常兴奋！`,-1),r(`p`,null,`与 Bun 一起推进 JavaScript 的性能边界，并与 Elysia 一起提升开发者体验，我们非常高兴能与您和我们的社区保持联系。`,-1),r(`p`,null,`每次更新都让 Elysia 变得更加稳定，并逐渐提供更好的开发者体验，同时不影响性能和功能。`,-1),r(`p`,null,`我们很高兴看到我们的开源开发者社区通过他们的项目使 Elysia 充满活力。`,-1),r(`ul`,null,[r(`li`,null,[r(`a`,{href:`https://github.com/timnghg/elysia-vite-plugin-ssr`,target:`_blank`,rel:`noreferrer`},`Elysia Vite 插件 SSR`),t(`，允许我们使用 Elysia 作为服务器进行 Vite 服务器端渲染。`)]),r(`li`,null,[r(`a`,{href:`https://github.com/timnghg/elysia-connect`,target:`_blank`,rel:`noreferrer`},`Elysia Connect`),t(`，使 Connect 的插件与 Elysia 兼容`)])],-1),r(`p`,null,`以及许多选择 Elysia 作为下一个大项目的开发者。`,-1),r(`p`,null,[t(`凭借我们的承诺，我们最近还推出了 `),r(`a`,{href:`https://github.com/saltyaom/mobius`,target:`_blank`,rel:`noreferrer`},`Mobius`),t(`，这是一个开源 TypeScript 库，可以将 GraphQL 解析为 TypeScript 类型，而无需依赖代码生成，利用 TypeScript 模板字面量类型，使其成为第一个实现端到端类型安全的框架，而不依赖代码生成。`)],-1),r(`p`,null,`我们非常感谢您对 Elysia 的持续支持，并希望能在下一次发布中与您一起推动边界。`,-1),r(`blockquote`,null,[r(`p`,null,`当这个全新世界为我欢呼时`),r(`p`,null,`我绝不会将其交给命运`),r(`p`,null,`当我看到机会时，我会开辟道路`),r(`p`,null,`我称之为将军`),r(`p`,null,`是时候突破了`),r(`p`,null,`所以我会重写故事，最终改变所有规则`),r(`p`,null,`我们是独行侠`),r(`p`,null,`我们不会放弃，直到赢得这场游戏`),r(`p`,null,`尽管我不知道明天会如何`),r(`p`,null,`我会下注，尽我所能赢得这场游戏`),r(`p`,null,`与其他人不同，我会尽力而为，我永远不会失败`),r(`p`,null,`放弃这个机会将是致命的，所以让我们全力以赴`),r(`p`,null,[t(`我将把我的命运寄托于此，让 `),r(`strong`,null,`游戏开始`)])],-1)]]),_:1})]))}});export{s as __pageData,c as default};